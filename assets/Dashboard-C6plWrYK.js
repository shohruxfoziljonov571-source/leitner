import{c as $,r as c,u as S,j as e,m as n,a as M,U as T,C as E,B as b,b as v,s as R,d as O,e as U,f as w,L as N}from"./index-H5eLpdEA.js";import{u as X,a as F}from"./useGamification-BtiiQjBl.js";import{S as j}from"./StatCard-CCVXhw6G.js";import{L as B}from"./LanguageSelector-CqqKwcb1.js";import{X as A}from"./XpBar-BK9iqufC.js";import{A as _,a as k,b as C}from"./avatar-DgHjWyI7.js";import{u as W}from"./useWeeklyChallenge-DfgJS0UP.js";import{L as G}from"./loader-circle-CZ1hHvJY.js";import{T as z}from"./trophy-BmylXmLN.js";import{C as H}from"./clock-C2GG-cMG.js";import{Z as I}from"./zap-Dyk872CS.js";import{T as P}from"./target-DMQ4a0xl.js";import{A as Z}from"./progress-D-FsW8vX.js";import{S as J}from"./sparkles-TJtHbwcC.js";import{T as K}from"./trending-up-C2EPqjgO.js";import{F as Y}from"./flame-VQLHS8Fr.js";import"./chevron-down-dSV5BqrI.js";import"./trash-2-CThAXJrU.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=$("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Q={1:"box1Desc",2:"box2Desc",3:"box3Desc",4:"box4Desc",5:"box5Desc"},D=c.memo(c.forwardRef(({boxNumber:s,wordCount:d,totalWords:t,delay:o=0},x)=>{const{t:m}=S(),u=t>0?d/t*100:0;return e.jsxs(n.div,{ref:x,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:o},className:"relative overflow-hidden rounded-2xl bg-card shadow-card p-5 group hover:shadow-elevated transition-shadow duration-300",children:[e.jsx("div",{className:"absolute top-4 right-4 w-10 h-10 rounded-xl flex items-center justify-center font-display font-bold text-lg",style:{backgroundColor:`hsl(var(--box-${s}) / 0.15)`,color:`hsl(var(--box-${s}))`},children:s}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"font-display font-semibold text-foreground text-lg mb-1",children:[m("box")," ",s]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m(Q[s])})]}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[e.jsx("span",{className:"font-display font-bold text-3xl text-foreground",children:d}),e.jsx("span",{className:"text-muted-foreground text-sm",children:m("words")})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(n.div,{initial:{width:0},animate:{width:`${u}%`},transition:{duration:.6,delay:o+.2},className:"h-full rounded-full",style:{backgroundColor:`hsl(var(--box-${s}))`}})})]})}));D.displayName="BoxCard";const V=()=>{var p,g,i,l,h,r;M();const{challenge:s,participants:d,userParticipation:t,userRank:o,daysLeft:x,isLoading:m,joinChallenge:u}=W(),y=async()=>{await u()?v.success("Challenge'ga qo'shildingiz! ðŸŽ‰"):v.error("Xatolik yuz berdi")};if(m)return e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(G,{className:"w-6 h-6 animate-spin text-primary"})});if(!s)return null;const a=d.slice(0,3);return e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-amber-500/10 via-orange-500/10 to-red-500/10 rounded-2xl p-5 border border-amber-500/20",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-500 to-orange-500 flex items-center justify-center shadow-lg",children:e.jsx(z,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Haftalik Challenge"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(H,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[x," kun qoldi"]}),e.jsx("span",{children:"â€¢"}),e.jsx(T,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[d.length," ishtirokchi"]})]})]})]})}),a.length>0&&e.jsxs("div",{className:"flex items-end justify-center gap-2 mb-4 h-32",children:[a[1]&&e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex flex-col items-center",children:[e.jsxs(_,{className:"w-10 h-10 border-2 border-gray-400",children:[a[1].avatar_url&&e.jsx(k,{src:a[1].avatar_url}),e.jsx(C,{className:"bg-gray-400 text-white text-xs",children:((p=a[1].full_name)==null?void 0:p.charAt(0))||"?"})]}),e.jsx("div",{className:"bg-gray-400 text-white text-xs font-bold px-2 py-1 rounded-t mt-1",children:"ðŸ¥ˆ"}),e.jsxs("div",{className:"bg-gray-400/20 w-16 h-16 rounded-t flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-xs font-medium truncate max-w-14",children:(g=a[1].full_name)==null?void 0:g.split(" ")[0]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[a[1].xp_earned," XP"]})]})]}),a[0]&&e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col items-center",children:[e.jsxs(_,{className:"w-12 h-12 border-2 border-amber-500 ring-2 ring-amber-500/30",children:[a[0].avatar_url&&e.jsx(k,{src:a[0].avatar_url}),e.jsx(C,{className:"bg-amber-500 text-white",children:((i=a[0].full_name)==null?void 0:i.charAt(0))||"?"})]}),e.jsx("div",{className:"bg-amber-500 text-white text-sm font-bold px-3 py-1 rounded-t mt-1",children:"ðŸ‘‘"}),e.jsxs("div",{className:"bg-amber-500/20 w-20 h-24 rounded-t flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-sm font-medium truncate max-w-18",children:(l=a[0].full_name)==null?void 0:l.split(" ")[0]}),e.jsxs("span",{className:"text-xs font-bold text-amber-600",children:[a[0].xp_earned," XP"]})]})]}),a[2]&&e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex flex-col items-center",children:[e.jsxs(_,{className:"w-9 h-9 border-2 border-amber-700",children:[a[2].avatar_url&&e.jsx(k,{src:a[2].avatar_url}),e.jsx(C,{className:"bg-amber-700 text-white text-xs",children:((h=a[2].full_name)==null?void 0:h.charAt(0))||"?"})]}),e.jsx("div",{className:"bg-amber-700 text-white text-xs font-bold px-2 py-1 rounded-t mt-1",children:"ðŸ¥‰"}),e.jsxs("div",{className:"bg-amber-700/20 w-14 h-12 rounded-t flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-xs font-medium truncate max-w-12",children:(r=a[2].full_name)==null?void 0:r.split(" ")[0]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[a[2].xp_earned," XP"]})]})]})]}),t?e.jsx("div",{className:"bg-card/50 backdrop-blur rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsxs("span",{className:"font-bold text-primary",children:["#",o]})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Sizning o'rningiz"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-3.5 h-3.5 text-amber-500"}),t.xp_earned," XP"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-3.5 h-3.5 text-green-500"}),t.words_reviewed," so'z"]})]})]})]}),e.jsx(E,{className:"w-5 h-5 text-muted-foreground"})]})}):e.jsxs(b,{onClick:y,className:"w-full gap-2 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white shadow-lg",children:[e.jsx(z,{className:"w-4 h-4"}),"Challenge'ga qo'shilish"]}),!t&&e.jsx("p",{className:"text-xs text-center text-muted-foreground mt-3",children:"Bu hafta eng ko'p XP yig'ing va g'olib bo'ling! ðŸ†"})]})},ee=()=>{const{user:s}=M(),{addXp:d}=X(),[t,o]=c.useState([]),[x,m]=c.useState([]),[u,y]=c.useState(!0),a=c.useCallback(async()=>{if(s)try{const{data:i,error:l}=await R.from("challenge_rewards").select(`
          *,
          weekly_challenges (week_start, week_end)
        `).eq("user_id",s.id).order("created_at",{ascending:!1});if(l)throw l;const h=(i||[]).map(r=>{var f,L;return{...r,badge_type:r.badge_type,week_start:(f=r.weekly_challenges)==null?void 0:f.week_start,week_end:(L=r.weekly_challenges)==null?void 0:L.week_end}});o(h),m(h.filter(r=>!r.claimed_at))}catch(i){console.error("Error fetching rewards:",i)}finally{y(!1)}},[s]),p=c.useCallback(async i=>{if(!s)return!1;try{const l=t.find(f=>f.id===i);if(!l||l.claimed_at)return!1;const{error:h}=await R.from("challenge_rewards").update({claimed_at:new Date().toISOString()}).eq("id",i).eq("user_id",s.id);if(h)throw h;await d(l.bonus_xp,"challenge_reward");const r=l.badge_type==="gold"?"ðŸ¥‡":l.badge_type==="silver"?"ðŸ¥ˆ":"ðŸ¥‰";return v.success(`${r} +${l.bonus_xp} XP olindi!`),await a(),!0}catch(l){return console.error("Error claiming reward:",l),v.error("Sovg'ani olishda xatolik"),!1}},[s,t,d,a]),g=c.useCallback(()=>({gold:t.filter(i=>i.badge_type==="gold").length,silver:t.filter(i=>i.badge_type==="silver").length,bronze:t.filter(i=>i.badge_type==="bronze").length}),[t]);return c.useEffect(()=>{a()},[a]),{rewards:t,unclaimedRewards:x,isLoading:u,claimReward:p,getTotalBadges:g,refetch:a}},se=({type:s,size:d="md",showLabel:t=!1,animate:o=!1})=>{const x={sm:"w-8 h-8 text-lg",md:"w-12 h-12 text-2xl",lg:"w-16 h-16 text-3xl"},m={gold:"from-yellow-400 to-amber-500 shadow-yellow-500/30",silver:"from-gray-300 to-slate-400 shadow-gray-400/30",bronze:"from-orange-400 to-amber-600 shadow-orange-500/30"},u={gold:"Oltin",silver:"Kumush",bronze:"Bronza"},y={gold:"ðŸ¥‡",silver:"ðŸ¥ˆ",bronze:"ðŸ¥‰"},a=O("rounded-full bg-gradient-to-br flex items-center justify-center shadow-lg",x[d],m[s]);return e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[o?e.jsx(n.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:15},className:a,children:e.jsx("span",{children:y[s]})}):e.jsx("div",{className:a,children:e.jsx("span",{children:y[s]})}),t&&e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:u[s]})]})},ae=()=>{const{unclaimedRewards:s,claimReward:d}=ee();return s.length===0?null:e.jsx(Z,{children:e.jsx(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-primary/20 via-secondary/20 to-primary/20 rounded-2xl p-4 border border-primary/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(q,{className:"w-5 h-5 text-primary"}),e.jsxs("h3",{className:"font-semibold text-foreground",children:["Olinmagan sovg'alar (",s.length,")"]}),e.jsx(J,{className:"w-4 h-4 text-yellow-500 animate-pulse"})]}),e.jsx("div",{className:"space-y-3",children:s.map(t=>e.jsxs(n.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between bg-card/80 rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{type:t.badge_type,size:"sm",animate:!0}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-foreground",children:["Haftalik challenge - ",t.rank===1?"1-o'rin":t.rank===2?"2-o'rin":"3-o'rin"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["+",t.bonus_xp," XP bonus"]})]})]}),e.jsxs(b,{size:"sm",onClick:()=>d(t.id),className:"gap-1",children:[e.jsx(q,{className:"w-4 h-4"}),"Olish"]})]},t.id))})]})})})},ve=()=>{const{t:s}=S(),{activeLanguage:d,isLoading:t}=U(),{stats:o,getBoxCounts:x,getWordsForReview:m,isLoading:u}=F(),{level:y,getUnlockedAchievements:a}=X(),p=c.useMemo(()=>x(),[x]),g=c.useMemo(()=>m(),[m]),i=c.useMemo(()=>Object.values(p).reduce((r,f)=>r+f,0),[p]),l=c.useMemo(()=>a(),[a]),h=c.useMemo(()=>o.today_reviewed>0?`${Math.round(o.today_correct/o.today_reviewed*100)}%`:"â€”",[o.today_correct,o.today_reviewed]);return u||t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse-soft text-muted-foreground",children:s("loading")})}):d?e.jsx("div",{className:"min-h-screen pb-24 md:pt-24 md:pb-8",children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"font-display font-bold text-3xl md:text-4xl text-foreground mb-2",children:[s("welcomeMessage")," ðŸ‘‹"]}),e.jsx("p",{className:"text-muted-foreground",children:g.length>0?`${g.length} so'z takrorlashni kutmoqda`:"Bugun uchun barcha so'zlar takrorlandi!"})]}),e.jsx(A,{compact:!0})]}),e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05},className:"mb-6",children:e.jsx(A,{})}),e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-6",children:e.jsx(B,{})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsx(j,{icon:w,label:s("totalWords"),value:i,delay:.15}),e.jsx(j,{icon:P,label:s("todayProgress"),value:o.today_reviewed,subtext:s("words"),delay:.2}),e.jsx(j,{icon:K,label:s("accuracy"),value:h,delay:.25}),e.jsx(j,{icon:Y,label:s("streak"),value:o.streak,subtext:"kun",gradient:!0,delay:.3})]}),e.jsx(ae,{}),e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.35},className:"mb-6",children:e.jsx(V,{})}),l.length>0&&e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"mb-6",children:e.jsx(N,{to:"/stats",className:"block",children:e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-secondary/10 rounded-2xl p-4 flex items-center justify-between hover:from-primary/20 hover:to-secondary/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:"Yutuqlar"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l.length," ta yutuq ochilgan"]})]})]}),e.jsx("div",{className:"flex -space-x-2",children:l.slice(0,5).map(r=>e.jsx("div",{className:"w-8 h-8 rounded-full bg-card flex items-center justify-center text-lg shadow-sm",children:r.icon},r.id))})]})})}),g.length>0&&e.jsx(n.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.4},className:"mb-8",children:e.jsx(N,{to:"/learn",children:e.jsxs(b,{size:"lg",className:"w-full md:w-auto gap-2 gradient-primary text-primary-foreground h-14 text-lg shadow-elevated",children:[e.jsx(w,{className:"w-5 h-5"}),s("startLearning")," (",g.length," so'z)"]})})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-display font-semibold text-xl text-foreground mb-4",children:"Leitner qutilar"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[1,2,3,4,5].map((r,f)=>e.jsx(D,{boxNumber:r,wordCount:p[r],totalWords:i,delay:.1*f},r))})]}),i===0&&e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-center py-12 px-6 rounded-3xl bg-card shadow-card",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-2xl gradient-primary flex items-center justify-center",children:e.jsx(w,{className:"w-10 h-10 text-primary-foreground"})}),e.jsx("h3",{className:"font-display font-semibold text-xl mb-2",children:"So'zlar hali yo'q"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-sm mx-auto",children:"Birinchi so'zingizni qo'shing va Leitner tizimi bilan o'rganishni boshlang!"}),e.jsx(N,{to:"/add",children:e.jsx(b,{size:"lg",className:"gap-2 gradient-primary text-primary-foreground",children:"Birinchi so'z qo'shish"})})]})]})}):e.jsx("div",{className:"min-h-screen pb-24 md:pt-24 md:pb-8",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-md",children:[e.jsxs(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-8 text-center",children:[e.jsxs("h1",{className:"font-display font-bold text-3xl md:text-4xl text-foreground mb-2",children:[s("welcomeMessage")," ðŸ‘‹"]}),e.jsx("p",{className:"text-muted-foreground",children:"Avval o'rganish tilini tanlang"})]}),e.jsx(B,{})]})})};export{ve as default};
