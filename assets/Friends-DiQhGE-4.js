import{c as ie,a as je,r as y,s as R,b as H,e as mt,j as e,m as U,X as Se,B as G,h as Ae,U as Ce,f as ht}from"./index-H5eLpdEA.js";import{I as Je}from"./input-CTxYhRwj.js";import{T as Ke,a as Qe,b as pe,c as xe,C as fe,d as ge,e as Ne,f as ke}from"./tabs-DZIfP3P_.js";import{A as ye,a as ve,b as be}from"./avatar-DgHjWyI7.js";import{B as Ue}from"./badge-4vPmJYcu.js";import{C as Ge}from"./clock-C2GG-cMG.js";import{T as we}from"./trophy-BmylXmLN.js";import{A as De,P as ft}from"./progress-D-FsW8vX.js";import{S as Ve}from"./sparkles-TJtHbwcC.js";import{D as gt,a as pt,b as xt,c as yt,d as vt}from"./dialog-DtFkyyB7.js";import{C as bt}from"./copy-D_y_CB_W.js";import{F as wt}from"./flame-VQLHS8Fr.js";import"./index-DuMAhUlO.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=ie("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=ie("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=ie("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=ie("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=ie("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=ie("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=ie("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=ie("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=ie("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),et=()=>{const{user:t}=je(),[s,n]=y.useState([]),[o,i]=y.useState([]),[g,b]=y.useState(null),[m,w]=y.useState(!0),c=y.useCallback(async()=>{var _;if(t)try{w(!0);const[p,h]=await Promise.all([R.from("profiles").select("friend_code").eq("user_id",t.id).single(),R.from("friendships").select("*").or(`user_id.eq.${t.id},friend_id.eq.${t.id}`)]);b(((_=p.data)==null?void 0:_.friend_code)||null);const I=h.data||[];if(I.length===0){n([]),i([]),w(!1);return}const f=I.map(u=>u.user_id===t.id?u.friend_id:u.user_id),[q,O]=await Promise.all([R.from("profiles").select("user_id, full_name, avatar_url").in("user_id",f),R.from("user_stats").select("user_id, xp, level, streak, total_words").in("user_id",f)]),z=new Map((q.data||[]).map(u=>[u.user_id,u])),V=new Map;for(const u of O.data||[]){const P=V.get(u.user_id);P?(P.xp+=u.xp||0,P.level=Math.max(P.level,u.level||1),P.streak=Math.max(P.streak,u.streak||0),P.totalWords+=u.total_words||0):V.set(u.user_id,{xp:u.xp||0,level:u.level||1,streak:u.streak||0,totalWords:u.total_words||0})}const D=[],l=[];for(const u of I){const P=u.user_id===t.id,Z=P?u.friend_id:u.user_id,B=z.get(Z),W=V.get(Z)||{xp:0,level:1,streak:0,totalWords:0},E={id:u.id,friendId:Z,fullName:(B==null?void 0:B.full_name)||"Foydalanuvchi",avatarUrl:(B==null?void 0:B.avatar_url)||null,xp:W.xp,level:W.level,streak:W.streak,totalWords:W.totalWords,status:u.status,isRequester:P};u.status==="accepted"?D.push(E):u.status==="pending"&&!P&&l.push(E)}D.sort((u,P)=>P.xp-u.xp),n(D),i(l)}catch(p){console.error("Error fetching friends:",p)}finally{w(!1)}},[t]);y.useEffect(()=>{c()},[c]);const N=y.useCallback(async _=>{if(!t)return!1;try{const{data:p,error:h}=await R.from("profiles").select("user_id, full_name").eq("friend_code",_.toUpperCase()).single();if(h||!p)return H.error("Do'st topilmadi"),!1;if(p.user_id===t.id)return H.error("O'zingizni qo'sha olmaysiz"),!1;const{data:I}=await R.from("friendships").select("id").or(`and(user_id.eq.${t.id},friend_id.eq.${p.user_id}),and(user_id.eq.${p.user_id},friend_id.eq.${t.id})`).maybeSingle();if(I)return H.error("Bu foydalanuvchi allaqachon do'stlar ro'yxatida"),!1;const{error:f}=await R.from("friendships").insert({user_id:t.id,friend_id:p.user_id,status:"pending"});if(f)throw f;return H.success(`${p.full_name||"Foydalanuvchi"}ga so'rov yuborildi`),c(),!0}catch(p){return console.error("Error adding friend:",p),H.error("Xatolik yuz berdi"),!1}},[t,c]),A=y.useCallback(async _=>{try{const{error:p}=await R.from("friendships").update({status:"accepted"}).eq("id",_);if(p)throw p;H.success("Do'st qo'shildi!"),c()}catch(p){console.error("Error accepting request:",p),H.error("Xatolik yuz berdi")}},[c]),k=y.useCallback(async _=>{try{const{error:p}=await R.from("friendships").update({status:"rejected"}).eq("id",_);if(p)throw p;H.success("So'rov rad etildi"),c()}catch(p){console.error("Error rejecting request:",p),H.error("Xatolik yuz berdi")}},[c]),M=y.useCallback(async _=>{try{const{error:p}=await R.from("friendships").delete().eq("id",_);if(p)throw p;H.success("Do'st o'chirildi"),c()}catch(p){console.error("Error removing friend:",p),H.error("Xatolik yuz berdi")}},[c]);return{friends:s,pendingRequests:o,myFriendCode:g,isLoading:m,addFriendByCode:N,acceptRequest:A,rejectRequest:k,removeFriend:M,refreshFriends:c}},Ct=()=>{const{user:t}=je(),[s,n]=y.useState([]),[o,i]=y.useState(!0),[g,b]=y.useState(null),m=y.useCallback(async()=>{if(t)try{i(!0);const[N,A]=await Promise.all([R.from("user_stats").select("user_id, xp, level, streak, total_words"),R.from("profiles").select("user_id, full_name, avatar_url")]);if(N.error)throw N.error;if(A.error)throw A.error;const k=new Map;for(const h of N.data||[]){const I=k.get(h.user_id);I?(I.xp+=h.xp||0,I.level=Math.max(I.level,h.level||1),I.streak=Math.max(I.streak,h.streak||0),I.totalWords+=h.total_words||0):k.set(h.user_id,{xp:h.xp||0,level:h.level||1,streak:h.streak||0,totalWords:h.total_words||0})}const M=new Map((A.data||[]).map(h=>[h.user_id,h])),_=[];for(const[h,I]of k.entries()){const f=M.get(h);_.push({userId:h,fullName:(f==null?void 0:f.full_name)||"Foydalanuvchi",avatarUrl:(f==null?void 0:f.avatar_url)||null,xp:I.xp,level:I.level,streak:I.streak,totalWords:I.totalWords,rank:0,isCurrentUser:h===t.id})}_.sort((h,I)=>I.xp-h.xp);let p=!1;_.forEach((h,I)=>{h.rank=I+1,h.isCurrentUser&&!p&&(b(h.rank),p=!0)}),n(_)}catch(N){console.error("Error fetching global leaderboard:",N)}finally{i(!1)}},[t]);y.useEffect(()=>{m()},[m]);const w=y.useCallback((N=10)=>s.slice(0,N),[s]),c=y.useCallback(()=>s.find(N=>N.isCurrentUser),[s]);return{globalLeaderboard:s,isLoading:o,myRank:g,getTopUsers:w,getCurrentUserPosition:c,refreshLeaderboard:m}};var ze={};(function t(s,n,o,i){var g=!!(s.Worker&&s.Blob&&s.Promise&&s.OffscreenCanvas&&s.OffscreenCanvasRenderingContext2D&&s.HTMLCanvasElement&&s.HTMLCanvasElement.prototype.transferControlToOffscreen&&s.URL&&s.URL.createObjectURL),b=typeof Path2D=="function"&&typeof DOMMatrix=="function",m=function(){if(!s.OffscreenCanvas)return!1;try{var r=new OffscreenCanvas(1,1),a=r.getContext("2d");a.fillRect(0,0,1,1);var d=r.transferToImageBitmap();a.createPattern(d,"no-repeat")}catch{return!1}return!0}();function w(){}function c(r){var a=n.exports.Promise,d=a!==void 0?a:s.Promise;return typeof d=="function"?new d(r):(r(w,w),null)}var N=function(r,a){return{transform:function(d){if(r)return d;if(a.has(d))return a.get(d);var x=new OffscreenCanvas(d.width,d.height),j=x.getContext("2d");return j.drawImage(d,0,0),a.set(d,x),x},clear:function(){a.clear()}}}(m,new Map),A=function(){var r=Math.floor(16.666666666666668),a,d,x={},j=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(a=function(C){var F=Math.random();return x[F]=requestAnimationFrame(function v(S){j===S||j+r-1<S?(j=S,delete x[F],C()):x[F]=requestAnimationFrame(v)}),F},d=function(C){x[C]&&cancelAnimationFrame(x[C])}):(a=function(C){return setTimeout(C,r)},d=function(C){return clearTimeout(C)}),{frame:a,cancel:d}}(),k=function(){var r,a,d={};function x(j){function C(F,v){j.postMessage({options:F||{},callback:v})}j.init=function(v){var S=v.transferControlToOffscreen();j.postMessage({canvas:S},[S])},j.fire=function(v,S,L){if(a)return C(v,null),a;var X=Math.random().toString(36).slice(2);return a=c(function($){function Y(J){J.data.callback===X&&(delete d[X],j.removeEventListener("message",Y),a=null,N.clear(),L(),$())}j.addEventListener("message",Y),C(v,X),d[X]=Y.bind(null,{data:{callback:X}})}),a},j.reset=function(){j.postMessage({reset:!0});for(var v in d)d[v](),delete d[v]}}return function(){if(r)return r;if(!o&&g){var j=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{r=new Worker(URL.createObjectURL(new Blob([j])))}catch(C){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",C),null}x(r)}return r}}(),M={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function _(r,a){return a?a(r):r}function p(r){return r!=null}function h(r,a,d){return _(r&&p(r[a])?r[a]:M[a],d)}function I(r){return r<0?0:Math.floor(r)}function f(r,a){return Math.floor(Math.random()*(a-r))+r}function q(r){return parseInt(r,16)}function O(r){return r.map(z)}function z(r){var a=String(r).replace(/[^0-9a-f]/gi,"");return a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),{r:q(a.substring(0,2)),g:q(a.substring(2,4)),b:q(a.substring(4,6))}}function V(r){var a=h(r,"origin",Object);return a.x=h(a,"x",Number),a.y=h(a,"y",Number),a}function D(r){r.width=document.documentElement.clientWidth,r.height=document.documentElement.clientHeight}function l(r){var a=r.getBoundingClientRect();r.width=a.width,r.height=a.height}function u(r){var a=document.createElement("canvas");return a.style.position="fixed",a.style.top="0px",a.style.left="0px",a.style.pointerEvents="none",a.style.zIndex=r,a}function P(r,a,d,x,j,C,F,v,S){r.save(),r.translate(a,d),r.rotate(C),r.scale(x,j),r.arc(0,0,1,F,v,S),r.restore()}function Z(r){var a=r.angle*(Math.PI/180),d=r.spread*(Math.PI/180);return{x:r.x,y:r.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:r.startVelocity*.5+Math.random()*r.startVelocity,angle2D:-a+(.5*d-Math.random()*d),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:r.color,shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,drift:r.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:r.gravity*3,ovalScalar:.6,scalar:r.scalar,flat:r.flat}}function B(r,a){a.x+=Math.cos(a.angle2D)*a.velocity+a.drift,a.y+=Math.sin(a.angle2D)*a.velocity+a.gravity,a.velocity*=a.decay,a.flat?(a.wobble=0,a.wobbleX=a.x+10*a.scalar,a.wobbleY=a.y+10*a.scalar,a.tiltSin=0,a.tiltCos=0,a.random=1):(a.wobble+=a.wobbleSpeed,a.wobbleX=a.x+10*a.scalar*Math.cos(a.wobble),a.wobbleY=a.y+10*a.scalar*Math.sin(a.wobble),a.tiltAngle+=.1,a.tiltSin=Math.sin(a.tiltAngle),a.tiltCos=Math.cos(a.tiltAngle),a.random=Math.random()+2);var d=a.tick++/a.totalTicks,x=a.x+a.random*a.tiltCos,j=a.y+a.random*a.tiltSin,C=a.wobbleX+a.random*a.tiltCos,F=a.wobbleY+a.random*a.tiltSin;if(r.fillStyle="rgba("+a.color.r+", "+a.color.g+", "+a.color.b+", "+(1-d)+")",r.beginPath(),b&&a.shape.type==="path"&&typeof a.shape.path=="string"&&Array.isArray(a.shape.matrix))r.fill(Pe(a.shape.path,a.shape.matrix,a.x,a.y,Math.abs(C-x)*.1,Math.abs(F-j)*.1,Math.PI/10*a.wobble));else if(a.shape.type==="bitmap"){var v=Math.PI/10*a.wobble,S=Math.abs(C-x)*.1,L=Math.abs(F-j)*.1,X=a.shape.bitmap.width*a.scalar,$=a.shape.bitmap.height*a.scalar,Y=new DOMMatrix([Math.cos(v)*S,Math.sin(v)*S,-Math.sin(v)*L,Math.cos(v)*L,a.x,a.y]);Y.multiplySelf(new DOMMatrix(a.shape.matrix));var J=r.createPattern(N.transform(a.shape.bitmap),"no-repeat");J.setTransform(Y),r.globalAlpha=1-d,r.fillStyle=J,r.fillRect(a.x-X/2,a.y-$/2,X,$),r.globalAlpha=1}else if(a.shape==="circle")r.ellipse?r.ellipse(a.x,a.y,Math.abs(C-x)*a.ovalScalar,Math.abs(F-j)*a.ovalScalar,Math.PI/10*a.wobble,0,2*Math.PI):P(r,a.x,a.y,Math.abs(C-x)*a.ovalScalar,Math.abs(F-j)*a.ovalScalar,Math.PI/10*a.wobble,0,2*Math.PI);else if(a.shape==="star")for(var T=Math.PI/2*3,Q=4*a.scalar,te=8*a.scalar,ae=a.x,le=a.y,de=5,re=Math.PI/de;de--;)ae=a.x+Math.cos(T)*te,le=a.y+Math.sin(T)*te,r.lineTo(ae,le),T+=re,ae=a.x+Math.cos(T)*Q,le=a.y+Math.sin(T)*Q,r.lineTo(ae,le),T+=re;else r.moveTo(Math.floor(a.x),Math.floor(a.y)),r.lineTo(Math.floor(a.wobbleX),Math.floor(j)),r.lineTo(Math.floor(C),Math.floor(F)),r.lineTo(Math.floor(x),Math.floor(a.wobbleY));return r.closePath(),r.fill(),a.tick<a.totalTicks}function W(r,a,d,x,j){var C=a.slice(),F=r.getContext("2d"),v,S,L=c(function(X){function $(){v=S=null,F.clearRect(0,0,x.width,x.height),N.clear(),j(),X()}function Y(){o&&!(x.width===i.width&&x.height===i.height)&&(x.width=r.width=i.width,x.height=r.height=i.height),!x.width&&!x.height&&(d(r),x.width=r.width,x.height=r.height),F.clearRect(0,0,x.width,x.height),C=C.filter(function(J){return B(F,J)}),C.length?v=A.frame(Y):$()}v=A.frame(Y),S=$});return{addFettis:function(X){return C=C.concat(X),L},canvas:r,promise:L,reset:function(){v&&A.cancel(v),S&&S()}}}function E(r,a){var d=!r,x=!!h(a||{},"resize"),j=!1,C=h(a,"disableForReducedMotion",Boolean),F=g&&!!h(a||{},"useWorker"),v=F?k():null,S=d?D:l,L=r&&v?!!r.__confetti_initialized:!1,X=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,$;function Y(T,Q,te){for(var ae=h(T,"particleCount",I),le=h(T,"angle",Number),de=h(T,"spread",Number),re=h(T,"startVelocity",Number),nt=h(T,"decay",Number),st=h(T,"gravity",Number),it=h(T,"drift",Number),Le=h(T,"colors",O),ot=h(T,"ticks",Number),Oe=h(T,"shapes"),lt=h(T,"scalar"),ct=!!h(T,"flat"),$e=V(T),Be=ae,Te=[],dt=r.width*$e.x,ut=r.height*$e.y;Be--;)Te.push(Z({x:dt,y:ut,angle:le,spread:de,startVelocity:re,color:Le[Be%Le.length],shape:Oe[f(0,Oe.length)],ticks:ot,decay:nt,gravity:st,drift:it,scalar:lt,flat:ct}));return $?$.addFettis(Te):($=W(r,Te,S,Q,te),$.promise)}function J(T){var Q=C||h(T,"disableForReducedMotion",Boolean),te=h(T,"zIndex",Number);if(Q&&X)return c(function(re){re()});d&&$?r=$.canvas:d&&!r&&(r=u(te),document.body.appendChild(r)),x&&!L&&S(r);var ae={width:r.width,height:r.height};v&&!L&&v.init(r),L=!0,v&&(r.__confetti_initialized=!0);function le(){if(v){var re={getBoundingClientRect:function(){if(!d)return r.getBoundingClientRect()}};S(re),v.postMessage({resize:{width:re.width,height:re.height}});return}ae.width=ae.height=null}function de(){$=null,x&&(j=!1,s.removeEventListener("resize",le)),d&&r&&(document.body.contains(r)&&document.body.removeChild(r),r=null,L=!1)}return x&&!j&&(j=!0,s.addEventListener("resize",le,!1)),v?v.fire(T,ae,de):Y(T,ae,de)}return J.reset=function(){v&&v.reset(),$&&$.reset()},J}var ee;function Me(){return ee||(ee=E(null,{useWorker:!0,resize:!0})),ee}function Pe(r,a,d,x,j,C,F){var v=new Path2D(r),S=new Path2D;S.addPath(v,new DOMMatrix(a));var L=new Path2D;return L.addPath(S,new DOMMatrix([Math.cos(F)*j,Math.sin(F)*j,-Math.sin(F)*C,Math.cos(F)*C,d,x])),L}function oe(r){if(!b)throw new Error("path confetti are not supported in this browser");var a,d;typeof r=="string"?a=r:(a=r.path,d=r.matrix);var x=new Path2D(a),j=document.createElement("canvas"),C=j.getContext("2d");if(!d){for(var F=1e3,v=F,S=F,L=0,X=0,$,Y,J=0;J<F;J+=2)for(var T=0;T<F;T+=2)C.isPointInPath(x,J,T,"nonzero")&&(v=Math.min(v,J),S=Math.min(S,T),L=Math.max(L,J),X=Math.max(X,T));$=L-v,Y=X-S;var Q=10,te=Math.min(Q/$,Q/Y);d=[te,0,0,te,-Math.round($/2+v)*te,-Math.round(Y/2+S)*te]}return{type:"path",path:a,matrix:d}}function he(r){var a,d=1,x="#000000",j='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof r=="string"?a=r:(a=r.text,d="scalar"in r?r.scalar:d,j="fontFamily"in r?r.fontFamily:j,x="color"in r?r.color:x);var C=10*d,F=""+C+"px "+j,v=new OffscreenCanvas(C,C),S=v.getContext("2d");S.font=F;var L=S.measureText(a),X=Math.ceil(L.actualBoundingBoxRight+L.actualBoundingBoxLeft),$=Math.ceil(L.actualBoundingBoxAscent+L.actualBoundingBoxDescent),Y=2,J=L.actualBoundingBoxLeft+Y,T=L.actualBoundingBoxAscent+Y;X+=Y+Y,$+=Y+Y,v=new OffscreenCanvas(X,$),S=v.getContext("2d"),S.font=F,S.fillStyle=x,S.fillText(a,J,T);var Q=1/d;return{type:"bitmap",bitmap:v.transferToImageBitmap(),matrix:[Q,0,0,Q,-X*Q/2,-$*Q/2]}}n.exports=function(){return Me().apply(this,arguments)},n.exports.reset=function(){Me().reset()},n.exports.create=E,n.exports.shapeFromPath=oe,n.exports.shapeFromText=he})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ze,!1);const ue=ze.exports;ze.exports.create;const tt=()=>{const s=Date.now()+3e3,n=(i,g)=>Math.random()*(g-i)+i,o=setInterval(()=>{const i=s-Date.now();if(i<=0){clearInterval(o);return}const g=50*(i/3e3);ue({particleCount:g,startVelocity:30,spread:360,origin:{x:n(.1,.3),y:Math.random()-.2},colors:["#FFD700","#FFA500","#FF6347","#9370DB","#00CED1"]}),ue({particleCount:g,startVelocity:30,spread:360,origin:{x:n(.7,.9),y:Math.random()-.2},colors:["#FFD700","#FFA500","#FF6347","#9370DB","#00CED1"]})},250)},at=()=>{const s={origin:{y:.7},zIndex:9999};function n(o,i){ue({...s,...i,particleCount:Math.floor(200*o)})}n(.25,{spread:26,startVelocity:55,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.2,{spread:60,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.35,{spread:100,decay:.91,scalar:.8,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.1,{spread:120,startVelocity:45,colors:["#FFD700","#FFC107","#FFEB3B"]})},Dt=()=>{ue({particleCount:100,spread:70,origin:{y:.6},colors:["#C0C0C0","#A9A9A9","#D3D3D3","#DCDCDC"],zIndex:9999})},Ft=()=>{ue({particleCount:80,spread:60,origin:{y:.6},colors:["#CD7F32","#B87333","#8B4513","#D2691E"],zIndex:9999})},St=()=>{const t={spread:360,ticks:100,gravity:0,decay:.94,startVelocity:30,shapes:["star"],colors:["#FFE400","#FFBD00","#E89400","#FFCA6C","#FDFFB8"],zIndex:9999};function s(){ue({...t,particleCount:40,scalar:1.2,origin:{x:.5,y:.5}}),ue({...t,particleCount:10,scalar:.75,origin:{x:.5,y:.5}})}setTimeout(s,0),setTimeout(s,100),setTimeout(s,200)},Re=()=>{const{user:t}=je(),{activeLanguage:s}=mt(),[n,o]=y.useState([]),[i,g]=y.useState(null),[b,m]=y.useState(!0),w=y.useCallback(async()=>{if(t)try{const{data:f,error:q}=await R.from("word_duels").select("*").or(`challenger_id.eq.${t.id},opponent_id.eq.${t.id}`).order("created_at",{ascending:!1});if(q)throw q;const O=new Set;f==null||f.forEach(l=>{O.add(l.challenger_id),O.add(l.opponent_id)});const{data:z}=await R.from("profiles").select("user_id, full_name, avatar_url").in("user_id",Array.from(O)),V=new Map((z==null?void 0:z.map(l=>[l.user_id,l]))||[]),D=(f||[]).map(l=>{var u,P,Z,B;return{...l,words:l.words||[],status:l.status,challenger_name:((u=V.get(l.challenger_id))==null?void 0:u.full_name)||"Noma'lum",opponent_name:((P=V.get(l.opponent_id))==null?void 0:P.full_name)||"Noma'lum",challenger_avatar:(Z=V.get(l.challenger_id))==null?void 0:Z.avatar_url,opponent_avatar:(B=V.get(l.opponent_id))==null?void 0:B.avatar_url}});o(D)}catch(f){console.error("Error fetching duels:",f)}finally{m(!1)}},[t]),c=y.useCallback(async(f,q=5)=>{if(!t||!s)return null;try{const{data:O,error:z}=await R.from("words").select("id, original_word, translated_word").eq("user_id",t.id).eq("user_language_id",s.id).limit(50);if(z)throw z;if(!O||O.length<q)return H.error(`Kamida ${q} ta so'z kerak!`),null;const D=[...O].sort(()=>Math.random()-.5).slice(0,q).map(P=>({id:P.id,original_word:P.original_word,translated_word:P.translated_word})),{data:l,error:u}=await R.from("word_duels").insert({challenger_id:t.id,opponent_id:f,word_count:q,words:D}).select().single();if(u)throw u;H.success("Duel yuborildi!");try{await R.functions.invoke("notify-duel",{body:{type:"duel_invite",duel_id:l.id,user_id:f}})}catch(P){console.log("Telegram notification failed:",P)}return await w(),l}catch(O){return console.error("Error creating duel:",O),H.error("Duel yaratishda xatolik"),null}},[t,s,w]),N=y.useCallback(async f=>{if(!t)return!1;try{const{error:q}=await R.from("word_duels").update({status:"active",started_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",f).eq("opponent_id",t.id);if(q)throw q;H.success("Duel boshlandi!");try{await R.functions.invoke("notify-duel",{body:{type:"duel_accepted",duel_id:f}})}catch(O){console.log("Telegram notification failed:",O)}return await w(),!0}catch(q){return console.error("Error accepting duel:",q),!1}},[t,w]),A=y.useCallback(async f=>{if(!t)return!1;try{const{error:q}=await R.from("word_duels").update({status:"declined",updated_at:new Date().toISOString()}).eq("id",f).eq("opponent_id",t.id);if(q)throw q;H.info("Duel rad etildi");try{await R.functions.invoke("notify-duel",{body:{type:"duel_declined",duel_id:f,user_id:t.id}})}catch(O){console.log("Telegram notification failed:",O)}return await w(),!0}catch(q){return console.error("Error declining duel:",q),!1}},[t,w]),k=y.useCallback(async(f,q,O,z)=>{if(!t)return!1;try{const{error:V}=await R.from("duel_responses").insert({duel_id:f,user_id:t.id,word_index:q,is_correct:O,response_time_ms:z});if(V)throw V;const{data:D,error:l}=await R.from("word_duels").select("*").eq("id",f).single();if(l)throw l;const u=D.challenger_id===t.id,P=u?"challenger_score":"opponent_score",Z=u?"challenger_time_ms":"opponent_time_ms",B=(u?D.challenger_score:D.opponent_score)+(O?1:0),W=(u?D.challenger_time_ms:D.opponent_time_ms)+z,E={[P]:B,[Z]:W,updated_at:new Date().toISOString()},{data:ee}=await R.from("duel_responses").select("*").eq("duel_id",f),Me=(ee||[]).filter(oe=>oe.user_id===D.challenger_id).length>=D.word_count,Pe=(ee||[]).filter(oe=>oe.user_id===D.opponent_id).length>=D.word_count;if(Me&&Pe){const oe=u?B:D.challenger_score,he=u?D.opponent_score:B,r=u?W:D.challenger_time_ms,a=u?D.opponent_time_ms:W;let d=null;if(oe>he?d=D.challenger_id:he>oe?d=D.opponent_id:r<a?d=D.challenger_id:a<r&&(d=D.opponent_id),E.status="completed",E.winner_id=d,E.completed_at=new Date().toISOString(),d===t.id){const j=(u?oe:he)/D.word_count;j>=.8?at():j>=.6?Dt():Ft(),H.success("ðŸ† Tabriklaymiz, siz g'olib!")}else d?H.info("Keyingi safar omad!"):(tt(),H.info("ðŸ¤ Durrang!"));try{await R.functions.invoke("notify-duel",{body:{type:"duel_completed",duel_id:f}})}catch(x){console.log("Telegram notification failed:",x)}}return await R.from("word_duels").update(E).eq("id",f),await w(),!0}catch(V){return console.error("Error submitting answer:",V),!1}},[t,w]),M=y.useCallback(f=>{g(f)},[]),_=y.useCallback(()=>{g(null),w()},[w]);y.useEffect(()=>{if(!t)return;let f=null;const q=()=>{f&&clearTimeout(f),f=setTimeout(()=>{w()},500)},O=R.channel(`duels-${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"word_duels"},z=>{var V,D,l,u;(((V=z.new)==null?void 0:V.challenger_id)===t.id||((D=z.new)==null?void 0:D.opponent_id)===t.id||((l=z.old)==null?void 0:l.challenger_id)===t.id||((u=z.old)==null?void 0:u.opponent_id)===t.id)&&q()}).subscribe();return()=>{f&&clearTimeout(f),R.removeChannel(O)}},[t,w]),y.useEffect(()=>{w()},[w]);const p=n.filter(f=>f.status==="pending"&&f.opponent_id===(t==null?void 0:t.id)),h=n.filter(f=>f.status==="active"),I=n.filter(f=>f.status==="completed");return{duels:n,pendingDuels:p,activeDuels:h,completedDuels:I,activeDuel:i,isLoading:b,createDuel:c,acceptDuel:N,declineDuel:A,submitAnswer:k,startDuel:M,endDuel:_,refetch:w}};function K(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function Pt(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}const _e=43200,Ye=1440;let Tt={};function It(){return Tt}function He(t){const s=K(t),n=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return n.setUTCFullYear(s.getFullYear()),+t-+n}function Fe(t,s){const n=K(t),o=K(s),i=n.getTime()-o.getTime();return i<0?-1:i>0?1:i}function qt(t){return Pt(t,Date.now())}function Wt(t,s){const n=K(t),o=K(s),i=n.getFullYear()-o.getFullYear(),g=n.getMonth()-o.getMonth();return i*12+g}function Et(t){return s=>{const o=(t?Math[t]:Math.trunc)(s);return o===0?0:o}}function At(t,s){return+K(t)-+K(s)}function zt(t){const s=K(t);return s.setHours(23,59,59,999),s}function Rt(t){const s=K(t),n=s.getMonth();return s.setFullYear(s.getFullYear(),n+1,0),s.setHours(23,59,59,999),s}function Lt(t){const s=K(t);return+zt(s)==+Rt(s)}function Ot(t,s){const n=K(t),o=K(s),i=Fe(n,o),g=Math.abs(Wt(n,o));let b;if(g<1)b=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*g);let m=Fe(n,o)===-i;Lt(K(t))&&g===1&&Fe(t,o)===1&&(m=!1),b=i*(g-Number(m))}return b===0?0:b}function $t(t,s,n){const o=At(t,s)/1e3;return Et(n==null?void 0:n.roundingMethod)(o)}const Bt={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ut=(t,s,n)=>{let o;const i=Bt[t];return typeof i=="string"?o=i:s===1?o=i.one:o=i.other.replace("{{count}}",s.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o};function me(t){return(s={})=>{const n=s.width?String(s.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Vt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Xt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Yt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ht={date:me({formats:Vt,defaultWidth:"full"}),time:me({formats:Xt,defaultWidth:"full"}),dateTime:me({formats:Yt,defaultWidth:"full"})},Jt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Kt=(t,s,n,o)=>Jt[t];function ne(t){return(s,n)=>{const o=n!=null&&n.context?String(n.context):"standalone";let i;if(o==="formatting"&&t.formattingValues){const b=t.defaultFormattingWidth||t.defaultWidth,m=n!=null&&n.width?String(n.width):b;i=t.formattingValues[m]||t.formattingValues[b]}else{const b=t.defaultWidth,m=n!=null&&n.width?String(n.width):t.defaultWidth;i=t.values[m]||t.values[b]}const g=t.argumentCallback?t.argumentCallback(s):s;return i[g]}}const Qt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Gt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Zt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ea={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ta={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},aa={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ra=(t,s)=>{const n=Number(t),o=n%100;if(o>20||o<10)switch(o%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},na={ordinalNumber:ra,era:ne({values:Qt,defaultWidth:"wide"}),quarter:ne({values:Gt,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ne({values:Zt,defaultWidth:"wide"}),day:ne({values:ea,defaultWidth:"wide"}),dayPeriod:ne({values:ta,defaultWidth:"wide",formattingValues:aa,defaultFormattingWidth:"wide"})};function se(t){return(s,n={})=>{const o=n.width,i=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],g=s.match(i);if(!g)return null;const b=g[0],m=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth],w=Array.isArray(m)?ia(m,A=>A.test(b)):sa(m,A=>A.test(b));let c;c=t.valueCallback?t.valueCallback(w):w,c=n.valueCallback?n.valueCallback(c):c;const N=s.slice(b.length);return{value:c,rest:N}}}function sa(t,s){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&s(t[n]))return n}function ia(t,s){for(let n=0;n<t.length;n++)if(s(t[n]))return n}function rt(t){return(s,n={})=>{const o=s.match(t.matchPattern);if(!o)return null;const i=o[0],g=s.match(t.parsePattern);if(!g)return null;let b=t.valueCallback?t.valueCallback(g[0]):g[0];b=n.valueCallback?n.valueCallback(b):b;const m=s.slice(i.length);return{value:b,rest:m}}}const oa=/^(\d+)(th|st|nd|rd)?/i,la=/\d+/i,ca={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},da={any:[/^b/i,/^(a|c)/i]},ua={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ma={any:[/1/i,/2/i,/3/i,/4/i]},ha={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},fa={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ga={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pa={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},xa={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ya={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},va={ordinalNumber:rt({matchPattern:oa,parsePattern:la,valueCallback:t=>parseInt(t,10)}),era:se({matchPatterns:ca,defaultMatchWidth:"wide",parsePatterns:da,defaultParseWidth:"any"}),quarter:se({matchPatterns:ua,defaultMatchWidth:"wide",parsePatterns:ma,defaultParseWidth:"any",valueCallback:t=>t+1}),month:se({matchPatterns:ha,defaultMatchWidth:"wide",parsePatterns:fa,defaultParseWidth:"any"}),day:se({matchPatterns:ga,defaultMatchWidth:"wide",parsePatterns:pa,defaultParseWidth:"any"}),dayPeriod:se({matchPatterns:xa,defaultMatchWidth:"any",parsePatterns:ya,defaultParseWidth:"any"})},ba={code:"en-US",formatDistance:Ut,formatLong:Ht,formatRelative:Kt,localize:na,match:va,options:{weekStartsOn:0,firstWeekContainsDate:1}};function wa(t,s,n){const o=It(),i=(n==null?void 0:n.locale)??o.locale??ba,g=2520,b=Fe(t,s);if(isNaN(b))throw new RangeError("Invalid time value");const m=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:b});let w,c;b>0?(w=K(s),c=K(t)):(w=K(t),c=K(s));const N=$t(c,w),A=(He(c)-He(w))/1e3,k=Math.round((N-A)/60);let M;if(k<2)return n!=null&&n.includeSeconds?N<5?i.formatDistance("lessThanXSeconds",5,m):N<10?i.formatDistance("lessThanXSeconds",10,m):N<20?i.formatDistance("lessThanXSeconds",20,m):N<40?i.formatDistance("halfAMinute",0,m):N<60?i.formatDistance("lessThanXMinutes",1,m):i.formatDistance("xMinutes",1,m):k===0?i.formatDistance("lessThanXMinutes",1,m):i.formatDistance("xMinutes",k,m);if(k<45)return i.formatDistance("xMinutes",k,m);if(k<90)return i.formatDistance("aboutXHours",1,m);if(k<Ye){const _=Math.round(k/60);return i.formatDistance("aboutXHours",_,m)}else{if(k<g)return i.formatDistance("xDays",1,m);if(k<_e){const _=Math.round(k/Ye);return i.formatDistance("xDays",_,m)}else if(k<_e*2)return M=Math.round(k/_e),i.formatDistance("aboutXMonths",M,m)}if(M=Ot(c,w),M<12){const _=Math.round(k/_e);return i.formatDistance("xMonths",_,m)}else{const _=M%12,p=Math.trunc(M/12);return _<3?i.formatDistance("aboutXYears",p,m):_<9?i.formatDistance("overXYears",p,m):i.formatDistance("almostXYears",p+1,m)}}function ja(t,s){return wa(t,qt(t),s)}const Ma={lessThanXSeconds:{one:"sekunddan kam",other:"{{count}} sekunddan kam"},xSeconds:{one:"1 sekund",other:"{{count}} sekund"},halfAMinute:"yarim minut",lessThanXMinutes:{one:"bir minutdan kam",other:"{{count}} minutdan kam"},xMinutes:{one:"1 minut",other:"{{count}} minut"},aboutXHours:{one:"tahminan 1 soat",other:"tahminan {{count}} soat"},xHours:{one:"1 soat",other:"{{count}} soat"},xDays:{one:"1 kun",other:"{{count}} kun"},aboutXWeeks:{one:"tahminan 1 hafta",other:"tahminan {{count}} hafta"},xWeeks:{one:"1 hafta",other:"{{count}} hafta"},aboutXMonths:{one:"tahminan 1 oy",other:"tahminan {{count}} oy"},xMonths:{one:"1 oy",other:"{{count}} oy"},aboutXYears:{one:"tahminan 1 yil",other:"tahminan {{count}} yil"},xYears:{one:"1 yil",other:"{{count}} yil"},overXYears:{one:"1 yildan ko'p",other:"{{count}} yildan ko'p"},almostXYears:{one:"deyarli 1 yil",other:"deyarli {{count}} yil"}},Na=(t,s,n)=>{let o;const i=Ma[t];return typeof i=="string"?o=i:s===1?o=i.one:o=i.other.replace("{{count}}",String(s)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?o+" dan keyin":o+" oldin":o},ka={full:"EEEE, do MMMM, y",long:"do MMMM, y",medium:"d MMM, y",short:"dd/MM/yyyy"},_a={full:"h:mm:ss zzzz",long:"h:mm:ss z",medium:"h:mm:ss",short:"h:mm"},Ca={any:"{{date}}, {{time}}"},Da={date:me({formats:ka,defaultWidth:"full"}),time:me({formats:_a,defaultWidth:"full"}),dateTime:me({formats:Ca,defaultWidth:"any"})},Fa={lastWeek:"'oldingi' eeee p 'da'",yesterday:"'kecha' p 'da'",today:"'bugun' p 'da'",tomorrow:"'ertaga' p 'da'",nextWeek:"eeee p 'da'",other:"P"},Sa=(t,s,n,o)=>Fa[t],Pa={narrow:["M.A","M."],abbreviated:["M.A","M."],wide:["Miloddan Avvalgi","Milodiy"]},Ta={narrow:["1","2","3","4"],abbreviated:["CH.1","CH.2","CH.3","CH.4"],wide:["1-chi chorak","2-chi chorak","3-chi chorak","4-chi chorak"]},Ia={narrow:["Y","F","M","A","M","I","I","A","S","O","N","D"],abbreviated:["Yan","Fev","Mar","Apr","May","Iyun","Iyul","Avg","Sen","Okt","Noy","Dek"],wide:["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"]},qa={narrow:["Y","D","S","CH","P","J","SH"],short:["Ya","Du","Se","Cho","Pa","Ju","Sha"],abbreviated:["Yak","Dush","Sesh","Chor","Pay","Jum","Shan"],wide:["Yakshanba","Dushanba","Seshanba","Chorshanba","Payshanba","Juma","Shanba"]},Wa={narrow:{am:"a",pm:"p",midnight:"y.t",noon:"p.",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},abbreviated:{am:"AM",pm:"PM",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},wide:{am:"a.m.",pm:"p.m.",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"}},Ea={narrow:{am:"a",pm:"p",midnight:"y.t",noon:"p.",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},abbreviated:{am:"AM",pm:"PM",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},wide:{am:"a.m.",pm:"p.m.",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"}},Aa=(t,s)=>String(t),za={ordinalNumber:Aa,era:ne({values:Pa,defaultWidth:"wide"}),quarter:ne({values:Ta,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ne({values:Ia,defaultWidth:"wide"}),day:ne({values:qa,defaultWidth:"wide"}),dayPeriod:ne({values:Wa,defaultWidth:"wide",formattingValues:Ea,defaultFormattingWidth:"wide"})},Ra=/^(\d+)(chi)?/i,La=/\d+/i,Oa={narrow:/^(m\.a|m\.)/i,abbreviated:/^(m\.a\.?\s?m\.?)/i,wide:/^(miloddan avval|miloddan keyin)/i},$a={any:[/^b/i,/^(a|c)/i]},Ba={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](chi)? chorak/i},Ua={any:[/1/i,/2/i,/3/i,/4/i]},Va={narrow:/^[yfmasond]/i,abbreviated:/^(yan|fev|mar|apr|may|iyun|iyul|avg|sen|okt|noy|dek)/i,wide:/^(yanvar|fevral|mart|aprel|may|iyun|iyul|avgust|sentabr|oktabr|noyabr|dekabr)/i},Xa={narrow:[/^y/i,/^f/i,/^m/i,/^a/i,/^m/i,/^i/i,/^i/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ya/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^iyun/i,/^iyul/i,/^av/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ya={narrow:/^[ydschj]/i,short:/^(ya|du|se|cho|pa|ju|sha)/i,abbreviated:/^(yak|dush|sesh|chor|pay|jum|shan)/i,wide:/^(yakshanba|dushanba|seshanba|chorshanba|payshanba|juma|shanba)/i},Ha={narrow:[/^y/i,/^d/i,/^s/i,/^ch/i,/^p/i,/^j/i,/^sh/i],any:[/^ya/i,/^d/i,/^se/i,/^ch/i,/^p/i,/^j/i,/^sh/i]},Ja={narrow:/^(a|p|y\.t|p| (ertalab|tushdan keyin|kechqurun|tun))/i,any:/^([ap]\.?\s?m\.?|yarim tun|peshin| (ertalab|tushdan keyin|kechqurun|tun))/i},Ka={any:{am:/^a/i,pm:/^p/i,midnight:/^y\.t/i,noon:/^pe/i,morning:/ertalab/i,afternoon:/tushdan keyin/i,evening:/kechqurun/i,night:/tun/i}},Qa={ordinalNumber:rt({matchPattern:Ra,parsePattern:La,valueCallback:t=>parseInt(t,10)}),era:se({matchPatterns:Oa,defaultMatchWidth:"wide",parsePatterns:$a,defaultParseWidth:"any"}),quarter:se({matchPatterns:Ba,defaultMatchWidth:"wide",parsePatterns:Ua,defaultParseWidth:"any",valueCallback:t=>t+1}),month:se({matchPatterns:Va,defaultMatchWidth:"wide",parsePatterns:Xa,defaultParseWidth:"any"}),day:se({matchPatterns:Ya,defaultMatchWidth:"wide",parsePatterns:Ha,defaultParseWidth:"any"}),dayPeriod:se({matchPatterns:Ja,defaultMatchWidth:"any",parsePatterns:Ka,defaultParseWidth:"any"})},Ga={code:"uz",formatDistance:Na,formatLong:Da,formatRelative:Sa,localize:za,match:Qa,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ie=({duel:t,onAccept:s,onDecline:n,onPlay:o})=>{var M,_;const{user:i}=je(),g=t.challenger_id===(i==null?void 0:i.id),b=t.opponent_id===(i==null?void 0:i.id),m=t.status==="pending",w=t.status==="active",c=t.status==="completed",N=t.winner_id===(i==null?void 0:i.id),A=c&&!t.winner_id,k=p=>p===0?"-":`${Math.floor(p/1e3)}s`;return e.jsxs(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`rounded-2xl p-4 border ${c?N?"bg-green-500/10 border-green-500/30":A?"bg-yellow-500/10 border-yellow-500/30":"bg-red-500/10 border-red-500/30":"bg-card border-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-primary"}),e.jsxs("span",{className:"font-semibold",children:[t.word_count," so'z"]})]}),m&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Ge,{className:"w-4 h-4"}),ja(new Date(t.expires_at),{locale:Ga,addSuffix:!0})]}),c&&e.jsx("div",{className:"flex items-center gap-1",children:N?e.jsx(we,{className:"w-5 h-5 text-yellow-500"}):A?e.jsx("span",{className:"text-sm text-yellow-600",children:"Durrang"}):e.jsx(Se,{className:"w-5 h-5 text-red-500"})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ye,{className:"w-10 h-10",children:[e.jsx(ve,{src:t.challenger_avatar}),e.jsx(be,{children:((M=t.challenger_name)==null?void 0:M[0])||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:g?"Siz":t.challenger_name}),(w||c)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t.challenger_score,"/",t.word_count]}),e.jsx(Ee,{className:"w-3 h-3"}),e.jsx("span",{children:k(t.challenger_time_ms)})]})]})]}),e.jsx("span",{className:"text-lg font-bold text-muted-foreground",children:"VS"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-sm",children:b?"Siz":t.opponent_name}),(w||c)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t.opponent_score,"/",t.word_count]}),e.jsx(Ee,{className:"w-3 h-3"}),e.jsx("span",{children:k(t.opponent_time_ms)})]})]}),e.jsxs(ye,{className:"w-10 h-10",children:[e.jsx(ve,{src:t.opponent_avatar}),e.jsx(be,{children:((_=t.opponent_name)==null?void 0:_[0])||"?"})]})]})]}),m&&b&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(G,{variant:"outline",size:"sm",onClick:n,className:"flex-1 gap-1",children:[e.jsx(Se,{className:"w-4 h-4"}),"Rad etish"]}),e.jsxs(G,{size:"sm",onClick:s,className:"flex-1 gap-1",children:[e.jsx(Ae,{className:"w-4 h-4"}),"Qabul qilish"]})]}),m&&g&&e.jsx("p",{className:"text-sm text-center text-muted-foreground",children:"Raqib javobini kutilmoqda..."}),w&&e.jsxs(G,{size:"sm",onClick:o,className:"w-full gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"O'ynash"]}),c&&e.jsx("p",{className:"text-sm text-center font-medium",children:N?"ðŸŽ‰ Tabriklaymiz, siz g'olib!":A?"ðŸ¤ Durrang!":"Keyingi safar omad!"})]})},Za=({duel:t,onComplete:s})=>{je();const{submitAnswer:n}=Re(),[o,i]=y.useState(0),[g,b]=y.useState(""),[m,w]=y.useState(Date.now()),[c,N]=y.useState([]),[A,k]=y.useState(!1),[M,_]=y.useState(null),[p,h]=y.useState(!1),[I,f]=y.useState(0),[q,O]=y.useState(!1),z=t.words[o],V=o/t.word_count*100;y.useEffect(()=>{if(p)return;const W=setInterval(()=>{f(Date.now()-m)},100);return()=>clearInterval(W)},[m,p]),y.useEffect(()=>{if(p){O(!0);const W=c.filter(E=>E.correct).length/t.word_count;W>=.8?(at(),setTimeout(()=>St(),500)):W>=.5&&tt()}},[p,c,t.word_count]);const D=y.useCallback(async()=>{if(!g.trim()||!z)return;const W=Date.now()-m,E=g.trim().toLowerCase()===z.translated_word.toLowerCase();_(E),k(!0),await n(t.id,o,E,W),N(ee=>[...ee,{correct:E,time:W}]),setTimeout(()=>{k(!1),o+1>=t.word_count?h(!0):(i(ee=>ee+1),b(""),w(Date.now()))},1e3)},[g,z,o,t.id,t.word_count,n,m]),l=W=>{W.key==="Enter"&&D()},u=W=>{const E=Math.floor(W/1e3),ee=Math.floor(W%1e3/100);return`${E}.${ee}s`},P=c.filter(W=>W.correct).length,Z=c.reduce((W,E)=>W+E.time,0),B=t.word_count>0?P/t.word_count*100:0;return p?e.jsxs(U.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12 relative",children:[e.jsx(De,{children:q&&e.jsx(e.Fragment,{children:[...Array(12)].map((W,E)=>e.jsx(U.div,{initial:{opacity:0,scale:0,x:0,y:0},animate:{opacity:[0,1,0],scale:[0,1,.5],x:(Math.random()-.5)*200,y:(Math.random()-.5)*200},transition:{duration:2,delay:E*.1,repeat:1/0,repeatDelay:1},className:"absolute left-1/2 top-1/4 text-2xl",children:["âœ¨","â­","ðŸŒŸ","ðŸ’«"][E%4]},E))})}),e.jsxs(U.div,{initial:{rotate:0,y:20},animate:{rotate:[0,-10,10,-10,0],y:[20,0,-10,0]},transition:{delay:.3,duration:.8,ease:"easeOut"},className:`w-28 h-28 mx-auto mb-6 rounded-3xl flex items-center justify-center relative ${B>=80?"bg-gradient-to-br from-yellow-400 via-yellow-500 to-amber-600":B>=50?"bg-gradient-to-br from-primary to-secondary":"bg-gradient-to-br from-gray-400 to-gray-500"}`,children:[B>=80?e.jsx(Ze,{className:"w-14 h-14 text-white drop-shadow-lg"}):B>=50?e.jsx(we,{className:"w-14 h-14 text-primary-foreground drop-shadow-lg"}):e.jsx(We,{className:"w-14 h-14 text-white drop-shadow-lg"}),B>=80&&e.jsx(U.div,{animate:{scale:[1,1.2,1],opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 rounded-3xl bg-yellow-400 blur-xl -z-10"})]}),e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx("h2",{className:"font-display font-bold text-3xl mb-2 flex items-center justify-center gap-2",children:B>=80?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-6 h-6 text-yellow-500"}),"Zo'r natija!",e.jsx(Ve,{className:"w-6 h-6 text-yellow-500"})]}):B>=50?"Yaxshi!":"Tugatildi!"}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["Natijangiz: ",P,"/",t.word_count," to'g'ri (",Math.round(B),"%)"]})]}),e.jsx(U.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.7},className:"bg-card rounded-2xl p-6 mb-6 max-w-sm mx-auto shadow-elevated",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx(U.p,{initial:{scale:0},animate:{scale:1},transition:{delay:.9,type:"spring"},className:"text-3xl font-bold text-green-500",children:P}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"To'g'ri"})]}),e.jsxs("div",{children:[e.jsx(U.p,{initial:{scale:0},animate:{scale:1},transition:{delay:1,type:"spring"},className:"text-3xl font-bold text-red-500",children:t.word_count-P}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Noto'g'ri"})]}),e.jsxs("div",{children:[e.jsx(U.p,{initial:{scale:0},animate:{scale:1},transition:{delay:1.1,type:"spring"},className:"text-3xl font-bold",children:u(Z)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vaqt"})]})]})}),e.jsx(U.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},className:"text-sm text-muted-foreground mb-6",children:"Raqibingiz o'ynashini kuting..."}),e.jsx(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:1.4},children:e.jsxs(G,{onClick:s,variant:"outline",className:"gap-2",children:[e.jsx(jt,{className:"w-4 h-4"}),"Orqaga"]})})]}):e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:[o+1," / ",t.word_count]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-primary",children:[e.jsx(Ee,{className:"w-4 h-4"}),u(I)]})]}),e.jsx(ft,{value:V,className:"h-2"})]}),e.jsx("div",{className:"flex justify-center gap-2 mb-6",children:Array.from({length:t.word_count}).map((W,E)=>e.jsx(U.div,{initial:E===o?{scale:0}:{},animate:E===o?{scale:1}:{},className:`w-3 h-3 rounded-full transition-colors ${E<c.length?c[E].correct?"bg-green-500":"bg-red-500":E===o?"bg-primary animate-pulse":"bg-muted"}`},E))}),e.jsx(De,{mode:"wait",children:e.jsxs(U.div,{initial:{opacity:0,x:50,rotateY:-15},animate:{opacity:1,x:0,rotateY:0},exit:{opacity:0,x:-50,rotateY:15},transition:{type:"spring",stiffness:300,damping:25},className:"bg-card rounded-3xl p-8 shadow-elevated mb-6 relative overflow-hidden",children:[e.jsx(De,{children:A&&e.jsx(U.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.1},className:`absolute inset-0 flex items-center justify-center ${M?"bg-green-500/90":"bg-red-500/90"}`,children:M?e.jsx(U.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200},children:e.jsx(Ae,{className:"w-20 h-20 text-white drop-shadow-lg"})}):e.jsxs(U.div,{initial:{scale:0},animate:{scale:1},className:"text-center text-white",children:[e.jsx(U.div,{animate:{x:[-5,5,-5,5,0]},transition:{duration:.4},children:e.jsx(Se,{className:"w-20 h-20 mx-auto mb-2 drop-shadow-lg"})}),e.jsx("p",{className:"font-medium text-lg",children:z==null?void 0:z.translated_word})]})})}),e.jsx("p",{className:"text-center text-sm text-muted-foreground mb-2",children:"Tarjima qiling:"}),e.jsx(U.h2,{initial:{scale:.9},animate:{scale:1},className:"text-center font-display font-bold text-3xl mb-6",children:z==null?void 0:z.original_word}),e.jsx(Je,{value:g,onChange:W=>b(W.target.value),onKeyPress:l,placeholder:"Tarjimani kiriting...",className:"text-center text-lg h-14",autoFocus:!0,disabled:A})]},o)}),e.jsx(U.div,{whileTap:{scale:.98},children:e.jsx(G,{onClick:D,className:"w-full h-14 text-lg",disabled:!g.trim()||A,children:"Tasdiqlash"})})]})},er=({trigger:t})=>{const{friends:s}=et(),{createDuel:n}=Re(),[o,i]=y.useState(!1),[g,b]=y.useState(null),[m,w]=y.useState(5),[c,N]=y.useState(!1),A=async()=>{if(!g)return;N(!0);const M=await n(g,m);N(!1),M&&(i(!1),b(null))},k=s.filter(M=>M.status==="accepted");return e.jsxs(gt,{open:o,onOpenChange:i,children:[e.jsx(pt,{asChild:!0,children:t||e.jsxs(G,{className:"gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Duel boshlash"]})}),e.jsxs(xt,{children:[e.jsx(yt,{children:e.jsxs(vt,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"Yangi duel"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"So'zlar soni:"}),e.jsx("div",{className:"flex gap-2",children:[5,10,15].map(M=>e.jsxs(G,{variant:m===M?"default":"outline",size:"sm",onClick:()=>w(M),children:[M," so'z"]},M))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Raqibni tanlang:"}),k.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ce,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Do'stlaringiz yo'q"}),e.jsx("p",{className:"text-xs",children:"Avval do'st qo'shing"})]}):e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:k.map(M=>{var _;return e.jsxs("button",{onClick:()=>b(M.friendId),className:`w-full flex items-center gap-3 p-3 rounded-xl transition-colors ${g===M.friendId?"bg-primary/10 border-2 border-primary":"bg-muted/50 hover:bg-muted border-2 border-transparent"}`,children:[e.jsxs(ye,{children:[e.jsx(ve,{src:M.avatarUrl||void 0}),e.jsx(be,{children:((_=M.fullName)==null?void 0:_[0])||"?"})]}),e.jsx("div",{className:"text-left",children:e.jsx("p",{className:"font-medium",children:M.fullName||"Noma'lum"})})]},M.id)})})]}),e.jsxs(G,{onClick:A,disabled:!g||c,className:"w-full gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),c?"Yuborilmoqda...":"Duel yuborish"]})]})]})]})},tr=()=>{const{pendingDuels:t,activeDuels:s,completedDuels:n,activeDuel:o,isLoading:i,acceptDuel:g,declineDuel:b,startDuel:m,endDuel:w}=Re();return i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Yuklanmoqda..."}):o?e.jsx(Za,{duel:o,onComplete:w}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"font-display font-semibold text-xl flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"So'z duellari"]}),e.jsx(er,{})]}),e.jsxs(Ke,{defaultValue:"pending",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-3",children:[e.jsxs(pe,{value:"pending",className:"gap-1",children:[e.jsx(Ge,{className:"w-4 h-4"}),"Kutilmoqda",t.length>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-primary text-primary-foreground rounded-full",children:t.length})]}),e.jsxs(pe,{value:"active",className:"gap-1",children:[e.jsx(ce,{className:"w-4 h-4"}),"Faol",s.length>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-green-500 text-white rounded-full",children:s.length})]}),e.jsxs(pe,{value:"completed",className:"gap-1",children:[e.jsx(we,{className:"w-4 h-4"}),"Tugatilgan"]})]}),e.jsx(xe,{value:"pending",className:"mt-4",children:t.length===0?e.jsx(qe,{message:"Kutilayotgan duellar yo'q"}):e.jsx("div",{className:"space-y-3",children:t.map(c=>e.jsx(Ie,{duel:c,onAccept:()=>g(c.id),onDecline:()=>b(c.id)},c.id))})}),e.jsx(xe,{value:"active",className:"mt-4",children:s.length===0?e.jsx(qe,{message:"Faol duellar yo'q"}):e.jsx("div",{className:"space-y-3",children:s.map(c=>e.jsx(Ie,{duel:c,onPlay:()=>m(c)},c.id))})}),e.jsx(xe,{value:"completed",className:"mt-4",children:n.length===0?e.jsx(qe,{message:"Tugatilgan duellar yo'q"}):e.jsx("div",{className:"space-y-3",children:n.slice(0,10).map(c=>e.jsx(Ie,{duel:c},c.id))})})]})]})},qe=({message:t})=>e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 text-muted-foreground",children:[e.jsx(ce,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:t})]}),gr=()=>{const{friends:t,pendingRequests:s,myFriendCode:n,isLoading:o,addFriendByCode:i,acceptRequest:g,rejectRequest:b,removeFriend:m}=et(),{globalLeaderboard:w,isLoading:c,myRank:N,getTopUsers:A}=Ct(),[k,M]=y.useState(""),[_,p]=y.useState(!1),[h,I]=y.useState(!1),f=()=>{n&&(navigator.clipboard.writeText(n),p(!0),H.success("Kod nusxalandi!"),setTimeout(()=>p(!1),2e3))},q=async()=>{if(!k.trim())return;I(!0),await i(k.trim())&&M(""),I(!1)};if(o||c)return e.jsx("div",{className:"min-h-screen flex items-center justify-center pb-20",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Yuklanmoqda..."})});const z=l=>l===1?e.jsx(Ze,{className:"w-5 h-5 text-yellow-500"}):l===2?e.jsx(We,{className:"w-5 h-5 text-gray-400"}):l===3?e.jsx(We,{className:"w-5 h-5 text-amber-700"}):null,V=(l,u)=>u?"bg-gradient-to-r from-primary/20 to-primary/5 border border-primary/30 ring-2 ring-primary/20":l===1?"bg-gradient-to-r from-yellow-500/20 to-yellow-500/5 border border-yellow-500/30":l===2?"bg-gradient-to-r from-gray-400/20 to-gray-400/5 border border-gray-400/30":l===3?"bg-gradient-to-r from-amber-700/20 to-amber-700/5 border border-amber-700/30":"bg-muted/50",D=({entry:l,showRemove:u=!1,onRemove:P})=>e.jsxs(U.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`flex items-center gap-3 p-3 rounded-xl ${V(l.rank,l.isCurrentUser)}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${l.rank===1?"bg-yellow-500 text-yellow-950":l.rank===2?"bg-gray-400 text-gray-950":l.rank===3?"bg-amber-700 text-white":"bg-muted text-muted-foreground"}`,children:z(l.rank)||l.rank}),e.jsxs(ye,{className:"h-10 w-10",children:[e.jsx(ve,{src:l.avatarUrl||void 0}),e.jsx(be,{children:(l.fullName||"U").charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-medium truncate flex items-center gap-1",children:[l.fullName||"Foydalanuvchi",l.isCurrentUser&&e.jsx(Ue,{variant:"secondary",className:"text-xs ml-1",children:"Siz"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Mt,{className:"w-3 h-3 text-primary"}),"Lvl ",l.level]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(wt,{className:"w-3 h-3 text-orange-500"}),l.streak]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ht,{className:"w-3 h-3"}),l.totalWords]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-primary",children:l.xp.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"XP"})]}),u&&P&&e.jsx(G,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:P,children:e.jsx(Se,{className:"w-4 h-4"})})]});return e.jsx("div",{className:"min-h-screen pb-24 pt-4 px-4",children:e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center justify-center gap-2",children:[e.jsx(Ce,{className:"w-6 h-6 text-primary"}),"Do'stlar va Reyting"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:N&&`Sizning o'rningiz: #${N}`})]}),e.jsx(fe,{className:"border-primary/20 bg-primary/5",children:e.jsxs(ge,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Mening kodim:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-background rounded-lg px-4 py-3 font-mono text-xl tracking-widest text-center",children:n||"--------"}),e.jsx(G,{size:"icon",variant:"outline",onClick:f,className:"h-12 w-12",children:_?e.jsx(Ae,{className:"w-5 h-5 text-green-500"}):e.jsx(bt,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Bu kodni do'stlaringizga yuboring"})]})}),e.jsxs(fe,{children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(ke,{className:"text-lg flex items-center gap-2",children:[e.jsx(kt,{className:"w-5 h-5"}),"Do'st qo'shish"]})}),e.jsx(ge,{className:"space-y-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Je,{placeholder:"Do'st kodini kiriting",value:k,onChange:l=>M(l.target.value.toUpperCase()),className:"font-mono tracking-wider",maxLength:8}),e.jsx(G,{onClick:q,disabled:h||!k.trim(),children:h?"Yuborilmoqda...":"Qo'shish"})]})})]}),e.jsx(De,{children:s.length>0&&e.jsx(U.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsxs(fe,{className:"border-yellow-500/20 bg-yellow-500/5",children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(ke,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ue,{variant:"secondary",className:"bg-yellow-500/20",children:s.length}),"Kutilayotgan so'rovlar"]})}),e.jsx(ge,{className:"space-y-3",children:s.map(l=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-background",children:[e.jsxs(ye,{className:"h-10 w-10",children:[e.jsx(ve,{src:l.avatarUrl||void 0}),e.jsx(be,{children:l.fullName.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:l.fullName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Do'st bo'lishni xohlaydi"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{size:"icon",variant:"outline",className:"h-9 w-9 text-green-500 hover:bg-green-500/10",onClick:()=>g(l.id),children:e.jsx(Nt,{className:"w-4 h-4"})}),e.jsx(G,{size:"icon",variant:"outline",className:"h-9 w-9 text-red-500 hover:bg-red-500/10",onClick:()=>b(l.id),children:e.jsx(_t,{className:"w-4 h-4"})})]})]},l.id))})]})})}),e.jsx(tr,{}),e.jsxs(Ke,{defaultValue:"global",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-2",children:[e.jsxs(pe,{value:"global",className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Umumiy"]}),e.jsxs(pe,{value:"friends",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Do'stlar"]})]}),e.jsx(xe,{value:"global",children:e.jsxs(fe,{children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(ke,{className:"text-lg flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-yellow-500"}),"Top 50 - Global Reyting"]})}),e.jsx(ge,{children:A(50).length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Xe,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Hali foydalanuvchilar yo'q"})]}):e.jsx("div",{className:"space-y-3",children:A(50).map((l,u)=>e.jsx(D,{entry:{...l,rank:u+1}},l.userId))})})]})}),e.jsx(xe,{value:"friends",children:e.jsxs(fe,{children:[e.jsx(Ne,{className:"pb-3",children:e.jsxs(ke,{className:"text-lg flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-yellow-500"}),"Do'stlar Reytingi"]})}),e.jsx(ge,{children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ce,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Hali do'stlar yo'q"}),e.jsx("p",{className:"text-sm mt-1",children:"Kodingizni do'stlaringizga yuboring yoki ularning kodini kiriting"})]}):e.jsx("div",{className:"space-y-3",children:t.map((l,u)=>e.jsx(D,{entry:{...l,rank:u+1,isCurrentUser:!1},showRemove:!0,onRemove:()=>m(l.id)},l.id))})})]})})]})]})})};export{gr as default};
