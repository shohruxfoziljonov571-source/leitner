import{c as ue,aj as ft,ak as Ke,al as xt,am as gt,a as ke,r as g,s as L,b as X,e as pt,j as e,m as I,X as Pe,B as Z,h as ze,U as Se,f as yt}from"./index-CF1n9Zjo.js";import{I as Qe}from"./input-CzQzjchC.js";import{T as Ge,a as Ze,b as be,c as ve,C as pe,d as ye,e as _e,f as Ce}from"./tabs-B3rVsSV5.js";import{A as we,a as je,b as Ne}from"./avatar-C74qAcNi.js";import{B as Ve}from"./badge-Bu64jCLE.js";import{C as et}from"./clock-BHZSe9ft.js";import{T as Me}from"./trophy-5FHGt_dO.js";import{T as qe}from"./timer-CJtvK6nT.js";import{P as bt}from"./progress-C_tDqEH4.js";import{A as xe}from"./index-DxdTuE2l.js";import{S as Ye}from"./sparkles-CFtBLySW.js";import{A as vt}from"./arrow-left-Bg5NUlVU.js";import{D as wt,a as jt,b as Nt,c as Mt,d as kt}from"./dialog-Dy2krPD9.js";import{C as _t}from"./copy-D5dTRsI8.js";import{F as Ct}from"./flame-KYC3gaCI.js";import"./index-s5eUj8tl.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=ue("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=ue("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=ue("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=ue("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=ue("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=ue("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=ue("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=ue("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function Tt(t){t.values.forEach(s=>s.stop())}function Ee(t,s){[...s].reverse().forEach(o=>{const i=t.getVariant(o);i&&Ke(t,i),t.variantChildren&&t.variantChildren.forEach(h=>{Ee(h,s)})})}function It(t,s){if(Array.isArray(s))return Ee(t,s);if(typeof s=="string")return Ee(t,[s]);Ke(t,s)}function At(){const t=new Set,s={subscribe(n){return t.add(n),()=>void t.delete(n)},start(n,o){const i=[];return t.forEach(h=>{i.push(ft(h,n,{transitionOverride:o}))}),Promise.all(i)},set(n){return t.forEach(o=>{It(o,n)})},stop(){t.forEach(n=>{Tt(n)})},mount(){return()=>{s.stop()}}};return s}function qt(){const t=xt(At);return gt(t.mount,[]),t}const Wt=qt,at=()=>{const{user:t}=ke(),[s,n]=g.useState([]),[o,i]=g.useState([]),[h,y]=g.useState(null),[x,b]=g.useState(!0),d=g.useCallback(async()=>{var M;if(t)try{b(!0);const[v,c]=await Promise.all([L.from("profiles").select("friend_code").eq("user_id",t.id).single(),L.from("friendships").select("*").or(`user_id.eq.${t.id},friend_id.eq.${t.id}`)]);y(((M=v.data)==null?void 0:M.friend_code)||null);const A=c.data||[];if(A.length===0){n([]),i([]),b(!1);return}const f=A.map(u=>u.user_id===t.id?u.friend_id:u.user_id),[D,q]=await Promise.all([L.from("profiles").select("user_id, full_name, avatar_url").in("user_id",f),L.from("user_stats").select("user_id, xp, level, streak, total_words").in("user_id",f)]),U=new Map((D.data||[]).map(u=>[u.user_id,u])),B=new Map;for(const u of q.data||[]){const C=B.get(u.user_id);C?(C.xp+=u.xp||0,C.level=Math.max(C.level,u.level||1),C.streak=Math.max(C.streak,u.streak||0),C.totalWords+=u.total_words||0):B.set(u.user_id,{xp:u.xp||0,level:u.level||1,streak:u.streak||0,totalWords:u.total_words||0})}const F=[],l=[];for(const u of A){const C=u.user_id===t.id,ee=C?u.friend_id:u.user_id,H=U.get(ee),te=B.get(ee)||{xp:0,level:1,streak:0,totalWords:0},G={id:u.id,friendId:ee,fullName:(H==null?void 0:H.full_name)||"Foydalanuvchi",avatarUrl:(H==null?void 0:H.avatar_url)||null,xp:te.xp,level:te.level,streak:te.streak,totalWords:te.totalWords,status:u.status,isRequester:C};u.status==="accepted"?F.push(G):u.status==="pending"&&!C&&l.push(G)}F.sort((u,C)=>C.xp-u.xp),n(F),i(l)}catch(v){console.error("Error fetching friends:",v)}finally{b(!1)}},[t]);g.useEffect(()=>{d()},[d]);const p=g.useCallback(async M=>{if(!t)return!1;try{const{data:v,error:c}=await L.from("profiles").select("user_id, full_name").eq("friend_code",M.toUpperCase()).single();if(c||!v)return X.error("Do'st topilmadi"),!1;if(v.user_id===t.id)return X.error("O'zingizni qo'sha olmaysiz"),!1;const{data:A}=await L.from("friendships").select("id").or(`and(user_id.eq.${t.id},friend_id.eq.${v.user_id}),and(user_id.eq.${v.user_id},friend_id.eq.${t.id})`).maybeSingle();if(A)return X.error("Bu foydalanuvchi allaqachon do'stlar ro'yxatida"),!1;const{error:f}=await L.from("friendships").insert({user_id:t.id,friend_id:v.user_id,status:"pending"});if(f)throw f;return X.success(`${v.full_name||"Foydalanuvchi"}ga so'rov yuborildi`),d(),!0}catch(v){return console.error("Error adding friend:",v),X.error("Xatolik yuz berdi"),!1}},[t,d]),E=g.useCallback(async M=>{try{const{error:v}=await L.from("friendships").update({status:"accepted"}).eq("id",M);if(v)throw v;X.success("Do'st qo'shildi!"),d()}catch(v){console.error("Error accepting request:",v),X.error("Xatolik yuz berdi")}},[d]),k=g.useCallback(async M=>{try{const{error:v}=await L.from("friendships").update({status:"rejected"}).eq("id",M);if(v)throw v;X.success("So'rov rad etildi"),d()}catch(v){console.error("Error rejecting request:",v),X.error("Xatolik yuz berdi")}},[d]),_=g.useCallback(async M=>{try{const{error:v}=await L.from("friendships").delete().eq("id",M);if(v)throw v;X.success("Do'st o'chirildi"),d()}catch(v){console.error("Error removing friend:",v),X.error("Xatolik yuz berdi")}},[d]);return{friends:s,pendingRequests:o,myFriendCode:h,isLoading:x,addFriendByCode:p,acceptRequest:E,rejectRequest:k,removeFriend:_,refreshFriends:d}},Et=()=>{const{user:t}=ke(),[s,n]=g.useState([]),[o,i]=g.useState(!0),[h,y]=g.useState(null),x=g.useCallback(async()=>{if(t)try{i(!0);const[p,E]=await Promise.all([L.from("user_stats").select("user_id, xp, level, streak, total_words"),L.from("profiles").select("user_id, full_name, avatar_url")]);if(p.error)throw p.error;if(E.error)throw E.error;const k=new Map;for(const c of p.data||[]){const A=k.get(c.user_id);A?(A.xp+=c.xp||0,A.level=Math.max(A.level,c.level||1),A.streak=Math.max(A.streak,c.streak||0),A.totalWords+=c.total_words||0):k.set(c.user_id,{xp:c.xp||0,level:c.level||1,streak:c.streak||0,totalWords:c.total_words||0})}const _=new Map((E.data||[]).map(c=>[c.user_id,c])),M=[];for(const[c,A]of k.entries()){const f=_.get(c);M.push({userId:c,fullName:(f==null?void 0:f.full_name)||"Foydalanuvchi",avatarUrl:(f==null?void 0:f.avatar_url)||null,xp:A.xp,level:A.level,streak:A.streak,totalWords:A.totalWords,rank:0,isCurrentUser:c===t.id})}M.sort((c,A)=>A.xp-c.xp);let v=!1;M.forEach((c,A)=>{c.rank=A+1,c.isCurrentUser&&!v&&(y(c.rank),v=!0)}),n(M)}catch(p){console.error("Error fetching global leaderboard:",p)}finally{i(!1)}},[t]);g.useEffect(()=>{x()},[x]);const b=g.useCallback((p=10)=>s.slice(0,p),[s]),d=g.useCallback(()=>s.find(p=>p.isCurrentUser),[s]);return{globalLeaderboard:s,isLoading:o,myRank:h,getTopUsers:b,getCurrentUserPosition:d,refreshLeaderboard:x}};var Le={};(function t(s,n,o,i){var h=!!(s.Worker&&s.Blob&&s.Promise&&s.OffscreenCanvas&&s.OffscreenCanvasRenderingContext2D&&s.HTMLCanvasElement&&s.HTMLCanvasElement.prototype.transferControlToOffscreen&&s.URL&&s.URL.createObjectURL),y=typeof Path2D=="function"&&typeof DOMMatrix=="function",x=function(){if(!s.OffscreenCanvas)return!1;try{var r=new OffscreenCanvas(1,1),a=r.getContext("2d");a.fillRect(0,0,1,1);var m=r.transferToImageBitmap();a.createPattern(m,"no-repeat")}catch{return!1}return!0}();function b(){}function d(r){var a=n.exports.Promise,m=a!==void 0?a:s.Promise;return typeof m=="function"?new m(r):(r(b,b),null)}var p=function(r,a){return{transform:function(m){if(r)return m;if(a.has(m))return a.get(m);var w=new OffscreenCanvas(m.width,m.height),N=w.getContext("2d");return N.drawImage(m,0,0),a.set(m,w),w},clear:function(){a.clear()}}}(x,new Map),E=function(){var r=Math.floor(16.666666666666668),a,m,w={},N=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(a=function(S){var P=Math.random();return w[P]=requestAnimationFrame(function j(T){N===T||N+r-1<T?(N=T,delete w[P],S()):w[P]=requestAnimationFrame(j)}),P},m=function(S){w[S]&&cancelAnimationFrame(w[S])}):(a=function(S){return setTimeout(S,r)},m=function(S){return clearTimeout(S)}),{frame:a,cancel:m}}(),k=function(){var r,a,m={};function w(N){function S(P,j){N.postMessage({options:P||{},callback:j})}N.init=function(j){var T=j.transferControlToOffscreen();N.postMessage({canvas:T},[T])},N.fire=function(j,T,O){if(a)return S(j,null),a;var V=Math.random().toString(36).slice(2);return a=d(function($){function Y(J){J.data.callback===V&&(delete m[V],N.removeEventListener("message",Y),a=null,p.clear(),O(),$())}N.addEventListener("message",Y),S(j,V),m[V]=Y.bind(null,{data:{callback:V}})}),a},N.reset=function(){N.postMessage({reset:!0});for(var j in m)m[j](),delete m[j]}}return function(){if(r)return r;if(!o&&h){var N=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{r=new Worker(URL.createObjectURL(new Blob([N])))}catch(S){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",S),null}w(r)}return r}}(),_={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function M(r,a){return a?a(r):r}function v(r){return r!=null}function c(r,a,m){return M(r&&v(r[a])?r[a]:_[a],m)}function A(r){return r<0?0:Math.floor(r)}function f(r,a){return Math.floor(Math.random()*(a-r))+r}function D(r){return parseInt(r,16)}function q(r){return r.map(U)}function U(r){var a=String(r).replace(/[^0-9a-f]/gi,"");return a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),{r:D(a.substring(0,2)),g:D(a.substring(2,4)),b:D(a.substring(4,6))}}function B(r){var a=c(r,"origin",Object);return a.x=c(a,"x",Number),a.y=c(a,"y",Number),a}function F(r){r.width=document.documentElement.clientWidth,r.height=document.documentElement.clientHeight}function l(r){var a=r.getBoundingClientRect();r.width=a.width,r.height=a.height}function u(r){var a=document.createElement("canvas");return a.style.position="fixed",a.style.top="0px",a.style.left="0px",a.style.pointerEvents="none",a.style.zIndex=r,a}function C(r,a,m,w,N,S,P,j,T){r.save(),r.translate(a,m),r.rotate(S),r.scale(w,N),r.arc(0,0,1,P,j,T),r.restore()}function ee(r){var a=r.angle*(Math.PI/180),m=r.spread*(Math.PI/180);return{x:r.x,y:r.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:r.startVelocity*.5+Math.random()*r.startVelocity,angle2D:-a+(.5*m-Math.random()*m),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:r.color,shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,drift:r.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:r.gravity*3,ovalScalar:.6,scalar:r.scalar,flat:r.flat}}function H(r,a){a.x+=Math.cos(a.angle2D)*a.velocity+a.drift,a.y+=Math.sin(a.angle2D)*a.velocity+a.gravity,a.velocity*=a.decay,a.flat?(a.wobble=0,a.wobbleX=a.x+10*a.scalar,a.wobbleY=a.y+10*a.scalar,a.tiltSin=0,a.tiltCos=0,a.random=1):(a.wobble+=a.wobbleSpeed,a.wobbleX=a.x+10*a.scalar*Math.cos(a.wobble),a.wobbleY=a.y+10*a.scalar*Math.sin(a.wobble),a.tiltAngle+=.1,a.tiltSin=Math.sin(a.tiltAngle),a.tiltCos=Math.cos(a.tiltAngle),a.random=Math.random()+2);var m=a.tick++/a.totalTicks,w=a.x+a.random*a.tiltCos,N=a.y+a.random*a.tiltSin,S=a.wobbleX+a.random*a.tiltCos,P=a.wobbleY+a.random*a.tiltSin;if(r.fillStyle="rgba("+a.color.r+", "+a.color.g+", "+a.color.b+", "+(1-m)+")",r.beginPath(),y&&a.shape.type==="path"&&typeof a.shape.path=="string"&&Array.isArray(a.shape.matrix))r.fill(ae(a.shape.path,a.shape.matrix,a.x,a.y,Math.abs(S-w)*.1,Math.abs(P-N)*.1,Math.PI/10*a.wobble));else if(a.shape.type==="bitmap"){var j=Math.PI/10*a.wobble,T=Math.abs(S-w)*.1,O=Math.abs(P-N)*.1,V=a.shape.bitmap.width*a.scalar,$=a.shape.bitmap.height*a.scalar,Y=new DOMMatrix([Math.cos(j)*T,Math.sin(j)*T,-Math.sin(j)*O,Math.cos(j)*O,a.x,a.y]);Y.multiplySelf(new DOMMatrix(a.shape.matrix));var J=r.createPattern(p.transform(a.shape.bitmap),"no-repeat");J.setTransform(Y),r.globalAlpha=1-m,r.fillStyle=J,r.fillRect(a.x-V/2,a.y-$/2,V,$),r.globalAlpha=1}else if(a.shape==="circle")r.ellipse?r.ellipse(a.x,a.y,Math.abs(S-w)*a.ovalScalar,Math.abs(P-N)*a.ovalScalar,Math.PI/10*a.wobble,0,2*Math.PI):C(r,a.x,a.y,Math.abs(S-w)*a.ovalScalar,Math.abs(P-N)*a.ovalScalar,Math.PI/10*a.wobble,0,2*Math.PI);else if(a.shape==="star")for(var W=Math.PI/2*3,Q=4*a.scalar,ne=8*a.scalar,se=a.x,ce=a.y,me=5,ie=Math.PI/me;me--;)se=a.x+Math.cos(W)*ne,ce=a.y+Math.sin(W)*ne,r.lineTo(se,ce),W+=ie,se=a.x+Math.cos(W)*Q,ce=a.y+Math.sin(W)*Q,r.lineTo(se,ce),W+=ie;else r.moveTo(Math.floor(a.x),Math.floor(a.y)),r.lineTo(Math.floor(a.wobbleX),Math.floor(N)),r.lineTo(Math.floor(S),Math.floor(P)),r.lineTo(Math.floor(w),Math.floor(a.wobbleY));return r.closePath(),r.fill(),a.tick<a.totalTicks}function te(r,a,m,w,N){var S=a.slice(),P=r.getContext("2d"),j,T,O=d(function(V){function $(){j=T=null,P.clearRect(0,0,w.width,w.height),p.clear(),N(),V()}function Y(){o&&!(w.width===i.width&&w.height===i.height)&&(w.width=r.width=i.width,w.height=r.height=i.height),!w.width&&!w.height&&(m(r),w.width=r.width,w.height=r.height),P.clearRect(0,0,w.width,w.height),S=S.filter(function(J){return H(P,J)}),S.length?j=E.frame(Y):$()}j=E.frame(Y),T=$});return{addFettis:function(V){return S=S.concat(V),O},canvas:r,promise:O,reset:function(){j&&E.cancel(j),T&&T()}}}function G(r,a){var m=!r,w=!!c(a||{},"resize"),N=!1,S=c(a,"disableForReducedMotion",Boolean),P=h&&!!c(a||{},"useWorker"),j=P?k():null,T=m?F:l,O=r&&j?!!r.__confetti_initialized:!1,V=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,$;function Y(W,Q,ne){for(var se=c(W,"particleCount",A),ce=c(W,"angle",Number),me=c(W,"spread",Number),ie=c(W,"startVelocity",Number),it=c(W,"decay",Number),ot=c(W,"gravity",Number),lt=c(W,"drift",Number),Oe=c(W,"colors",q),ct=c(W,"ticks",Number),$e=c(W,"shapes"),dt=c(W,"scalar"),ut=!!c(W,"flat"),Be=B(W),Ue=se,Te=[],mt=r.width*Be.x,ht=r.height*Be.y;Ue--;)Te.push(ee({x:mt,y:ht,angle:ce,spread:me,startVelocity:ie,color:Oe[Ue%Oe.length],shape:$e[f(0,$e.length)],ticks:ct,decay:it,gravity:ot,drift:lt,scalar:dt,flat:ut}));return $?$.addFettis(Te):($=te(r,Te,T,Q,ne),$.promise)}function J(W){var Q=S||c(W,"disableForReducedMotion",Boolean),ne=c(W,"zIndex",Number);if(Q&&V)return d(function(ie){ie()});m&&$?r=$.canvas:m&&!r&&(r=u(ne),document.body.appendChild(r)),w&&!O&&T(r);var se={width:r.width,height:r.height};j&&!O&&j.init(r),O=!0,j&&(r.__confetti_initialized=!0);function ce(){if(j){var ie={getBoundingClientRect:function(){if(!m)return r.getBoundingClientRect()}};T(ie),j.postMessage({resize:{width:ie.width,height:ie.height}});return}se.width=se.height=null}function me(){$=null,w&&(N=!1,s.removeEventListener("resize",ce)),m&&r&&(document.body.contains(r)&&document.body.removeChild(r),r=null,O=!1)}return w&&!N&&(N=!0,s.addEventListener("resize",ce,!1)),j?j.fire(W,se,me):Y(W,se,me)}return J.reset=function(){j&&j.reset(),$&&$.reset()},J}var re;function fe(){return re||(re=G(null,{useWorker:!0,resize:!0})),re}function ae(r,a,m,w,N,S,P){var j=new Path2D(r),T=new Path2D;T.addPath(j,new DOMMatrix(a));var O=new Path2D;return O.addPath(T,new DOMMatrix([Math.cos(P)*N,Math.sin(P)*N,-Math.sin(P)*S,Math.cos(P)*S,m,w])),O}function z(r){if(!y)throw new Error("path confetti are not supported in this browser");var a,m;typeof r=="string"?a=r:(a=r.path,m=r.matrix);var w=new Path2D(a),N=document.createElement("canvas"),S=N.getContext("2d");if(!m){for(var P=1e3,j=P,T=P,O=0,V=0,$,Y,J=0;J<P;J+=2)for(var W=0;W<P;W+=2)S.isPointInPath(w,J,W,"nonzero")&&(j=Math.min(j,J),T=Math.min(T,W),O=Math.max(O,J),V=Math.max(V,W));$=O-j,Y=V-T;var Q=10,ne=Math.min(Q/$,Q/Y);m=[ne,0,0,ne,-Math.round($/2+j)*ne,-Math.round(Y/2+T)*ne]}return{type:"path",path:a,matrix:m}}function R(r){var a,m=1,w="#000000",N='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof r=="string"?a=r:(a=r.text,m="scalar"in r?r.scalar:m,N="fontFamily"in r?r.fontFamily:N,w="color"in r?r.color:w);var S=10*m,P=""+S+"px "+N,j=new OffscreenCanvas(S,S),T=j.getContext("2d");T.font=P;var O=T.measureText(a),V=Math.ceil(O.actualBoundingBoxRight+O.actualBoundingBoxLeft),$=Math.ceil(O.actualBoundingBoxAscent+O.actualBoundingBoxDescent),Y=2,J=O.actualBoundingBoxLeft+Y,W=O.actualBoundingBoxAscent+Y;V+=Y+Y,$+=Y+Y,j=new OffscreenCanvas(V,$),T=j.getContext("2d"),T.font=P,T.fillStyle=w,T.fillText(a,J,W);var Q=1/m;return{type:"bitmap",bitmap:j.transferToImageBitmap(),matrix:[Q,0,0,Q,-V*Q/2,-$*Q/2]}}n.exports=function(){return fe().apply(this,arguments)},n.exports.reset=function(){fe().reset()},n.exports.create=G,n.exports.shapeFromPath=z,n.exports.shapeFromText=R})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Le,!1);const he=Le.exports;Le.exports.create;const rt=()=>{const s=Date.now()+3e3,n=(i,h)=>Math.random()*(h-i)+i,o=setInterval(()=>{const i=s-Date.now();if(i<=0){clearInterval(o);return}const h=50*(i/3e3);he({particleCount:h,startVelocity:30,spread:360,origin:{x:n(.1,.3),y:Math.random()-.2},colors:["#FFD700","#FFA500","#FF6347","#9370DB","#00CED1"]}),he({particleCount:h,startVelocity:30,spread:360,origin:{x:n(.7,.9),y:Math.random()-.2},colors:["#FFD700","#FFA500","#FF6347","#9370DB","#00CED1"]})},250)},nt=()=>{const s={origin:{y:.7},zIndex:9999};function n(o,i){he({...s,...i,particleCount:Math.floor(200*o)})}n(.25,{spread:26,startVelocity:55,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.2,{spread:60,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.35,{spread:100,decay:.91,scalar:.8,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2,colors:["#FFD700","#FFC107","#FFEB3B"]}),n(.1,{spread:120,startVelocity:45,colors:["#FFD700","#FFC107","#FFEB3B"]})},zt=()=>{he({particleCount:100,spread:70,origin:{y:.6},colors:["#C0C0C0","#A9A9A9","#D3D3D3","#DCDCDC"],zIndex:9999})},Lt=()=>{he({particleCount:80,spread:60,origin:{y:.6},colors:["#CD7F32","#B87333","#8B4513","#D2691E"],zIndex:9999})},Rt=()=>{const t={spread:360,ticks:100,gravity:0,decay:.94,startVelocity:30,shapes:["star"],colors:["#FFE400","#FFBD00","#E89400","#FFCA6C","#FDFFB8"],zIndex:9999};function s(){he({...t,particleCount:40,scalar:1.2,origin:{x:.5,y:.5}}),he({...t,particleCount:10,scalar:.75,origin:{x:.5,y:.5}})}setTimeout(s,0),setTimeout(s,100),setTimeout(s,200)},Re=()=>{const{user:t}=ke(),{activeLanguage:s}=pt(),[n,o]=g.useState([]),[i,h]=g.useState(null),[y,x]=g.useState(!0),b=g.useCallback(async()=>{if(t)try{const{data:f,error:D}=await L.from("word_duels").select("*").or(`challenger_id.eq.${t.id},opponent_id.eq.${t.id}`).order("created_at",{ascending:!1});if(D)throw D;const q=new Set;f==null||f.forEach(l=>{q.add(l.challenger_id),q.add(l.opponent_id)});const{data:U}=await L.from("profiles").select("user_id, full_name, avatar_url").in("user_id",Array.from(q)),B=new Map((U==null?void 0:U.map(l=>[l.user_id,l]))||[]),F=(f||[]).map(l=>{var u,C,ee,H;return{...l,words:l.words||[],status:l.status,challenger_name:((u=B.get(l.challenger_id))==null?void 0:u.full_name)||"Noma'lum",opponent_name:((C=B.get(l.opponent_id))==null?void 0:C.full_name)||"Noma'lum",challenger_avatar:(ee=B.get(l.challenger_id))==null?void 0:ee.avatar_url,opponent_avatar:(H=B.get(l.opponent_id))==null?void 0:H.avatar_url}});o(F)}catch(f){console.error("Error fetching duels:",f)}finally{x(!1)}},[t]),d=g.useCallback(async(f,D=5)=>{if(!t||!s)return null;try{const{data:q,error:U}=await L.from("words").select("id, original_word, translated_word").eq("user_id",t.id).eq("user_language_id",s.id).limit(50);if(U)throw U;if(!q||q.length<D)return X.error(`Kamida ${D} ta so'z kerak!`),null;const F=[...q].sort(()=>Math.random()-.5).slice(0,D).map(C=>({id:C.id,original_word:C.original_word,translated_word:C.translated_word})),{data:l,error:u}=await L.from("word_duels").insert({challenger_id:t.id,opponent_id:f,word_count:D,words:F}).select().single();if(u)throw u;X.success("Duel yuborildi!");try{await L.functions.invoke("notify-duel",{body:{type:"duel_invite",duel_id:l.id,user_id:f}})}catch(C){console.log("Telegram notification failed:",C)}return await b(),l}catch(q){return console.error("Error creating duel:",q),X.error("Duel yaratishda xatolik"),null}},[t,s,b]),p=g.useCallback(async f=>{if(!t)return!1;try{const{error:D}=await L.from("word_duels").update({status:"active",started_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",f).eq("opponent_id",t.id);if(D)throw D;X.success("Duel boshlandi!");try{await L.functions.invoke("notify-duel",{body:{type:"duel_accepted",duel_id:f}})}catch(q){console.log("Telegram notification failed:",q)}return await b(),!0}catch(D){return console.error("Error accepting duel:",D),!1}},[t,b]),E=g.useCallback(async f=>{if(!t)return!1;try{const{error:D}=await L.from("word_duels").update({status:"declined",updated_at:new Date().toISOString()}).eq("id",f).eq("opponent_id",t.id);if(D)throw D;X.info("Duel rad etildi");try{await L.functions.invoke("notify-duel",{body:{type:"duel_declined",duel_id:f,user_id:t.id}})}catch(q){console.log("Telegram notification failed:",q)}return await b(),!0}catch(D){return console.error("Error declining duel:",D),!1}},[t,b]),k=g.useCallback(async(f,D,q,U)=>{if(!t)return!1;try{const{error:B}=await L.from("duel_responses").insert({duel_id:f,user_id:t.id,word_index:D,is_correct:q,response_time_ms:U});if(B)throw B;const{data:F,error:l}=await L.from("word_duels").select("*").eq("id",f).single();if(l)throw l;const u=F.challenger_id===t.id,C=u?"challenger_score":"opponent_score",ee=u?"challenger_time_ms":"opponent_time_ms",H=(u?F.challenger_score:F.opponent_score)+(q?1:0),te=(u?F.challenger_time_ms:F.opponent_time_ms)+U,G={[C]:H,[ee]:te,updated_at:new Date().toISOString()},{data:re}=await L.from("duel_responses").select("*").eq("duel_id",f),fe=(re||[]).filter(z=>z.user_id===F.challenger_id).length>=F.word_count,ae=(re||[]).filter(z=>z.user_id===F.opponent_id).length>=F.word_count;if(fe&&ae){const z=u?H:F.challenger_score,R=u?F.opponent_score:H,r=u?te:F.challenger_time_ms,a=u?F.opponent_time_ms:te;let m=null;if(z>R?m=F.challenger_id:R>z?m=F.opponent_id:r<a?m=F.challenger_id:a<r&&(m=F.opponent_id),G.status="completed",G.winner_id=m,G.completed_at=new Date().toISOString(),m===t.id){const N=(u?z:R)/F.word_count;N>=.8?nt():N>=.6?zt():Lt(),X.success("ðŸ† Tabriklaymiz, siz g'olib!")}else m?X.info("Keyingi safar omad!"):(rt(),X.info("ðŸ¤ Durrang!"));try{await L.functions.invoke("notify-duel",{body:{type:"duel_completed",duel_id:f}})}catch(w){console.log("Telegram notification failed:",w)}}return await L.from("word_duels").update(G).eq("id",f),await b(),!0}catch(B){return console.error("Error submitting answer:",B),!1}},[t,b]),_=g.useCallback(f=>{h(f)},[]),M=g.useCallback(()=>{h(null),b()},[b]);g.useEffect(()=>{if(!t)return;let f=null;const D=()=>{f&&clearTimeout(f),f=setTimeout(()=>{b()},500)},q=L.channel(`duels-${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"word_duels"},U=>{var B,F,l,u;(((B=U.new)==null?void 0:B.challenger_id)===t.id||((F=U.new)==null?void 0:F.opponent_id)===t.id||((l=U.old)==null?void 0:l.challenger_id)===t.id||((u=U.old)==null?void 0:u.opponent_id)===t.id)&&D()}).subscribe();return()=>{f&&clearTimeout(f),L.removeChannel(q)}},[t,b]),g.useEffect(()=>{b()},[b]);const v=n.filter(f=>f.status==="pending"&&f.opponent_id===(t==null?void 0:t.id)),c=n.filter(f=>f.status==="active"),A=n.filter(f=>f.status==="completed");return{duels:n,pendingDuels:v,activeDuels:c,completedDuels:A,activeDuel:i,isLoading:y,createDuel:d,acceptDuel:p,declineDuel:E,submitAnswer:k,startDuel:_,endDuel:M,refetch:b}};function K(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function Ot(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}const De=43200,He=1440;let $t={};function Bt(){return $t}function Je(t){const s=K(t),n=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return n.setUTCFullYear(s.getFullYear()),+t-+n}function Fe(t,s){const n=K(t),o=K(s),i=n.getTime()-o.getTime();return i<0?-1:i>0?1:i}function Ut(t){return Ot(t,Date.now())}function Vt(t,s){const n=K(t),o=K(s),i=n.getFullYear()-o.getFullYear(),h=n.getMonth()-o.getMonth();return i*12+h}function Yt(t){return s=>{const o=(t?Math[t]:Math.trunc)(s);return o===0?0:o}}function Xt(t,s){return+K(t)-+K(s)}function Ht(t){const s=K(t);return s.setHours(23,59,59,999),s}function Jt(t){const s=K(t),n=s.getMonth();return s.setFullYear(s.getFullYear(),n+1,0),s.setHours(23,59,59,999),s}function Kt(t){const s=K(t);return+Ht(s)==+Jt(s)}function Qt(t,s){const n=K(t),o=K(s),i=Fe(n,o),h=Math.abs(Vt(n,o));let y;if(h<1)y=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*h);let x=Fe(n,o)===-i;Kt(K(t))&&h===1&&Fe(t,o)===1&&(x=!1),y=i*(h-Number(x))}return y===0?0:y}function Gt(t,s,n){const o=Xt(t,s)/1e3;return Yt(n==null?void 0:n.roundingMethod)(o)}const Zt={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ea=(t,s,n)=>{let o;const i=Zt[t];return typeof i=="string"?o=i:s===1?o=i.one:o=i.other.replace("{{count}}",s.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o};function ge(t){return(s={})=>{const n=s.width?String(s.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const ta={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},aa={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ra={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},na={date:ge({formats:ta,defaultWidth:"full"}),time:ge({formats:aa,defaultWidth:"full"}),dateTime:ge({formats:ra,defaultWidth:"full"})},sa={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ia=(t,s,n,o)=>sa[t];function oe(t){return(s,n)=>{const o=n!=null&&n.context?String(n.context):"standalone";let i;if(o==="formatting"&&t.formattingValues){const y=t.defaultFormattingWidth||t.defaultWidth,x=n!=null&&n.width?String(n.width):y;i=t.formattingValues[x]||t.formattingValues[y]}else{const y=t.defaultWidth,x=n!=null&&n.width?String(n.width):t.defaultWidth;i=t.values[x]||t.values[y]}const h=t.argumentCallback?t.argumentCallback(s):s;return i[h]}}const oa={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},la={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ca={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},da={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ua={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ma={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ha=(t,s)=>{const n=Number(t),o=n%100;if(o>20||o<10)switch(o%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},fa={ordinalNumber:ha,era:oe({values:oa,defaultWidth:"wide"}),quarter:oe({values:la,defaultWidth:"wide",argumentCallback:t=>t-1}),month:oe({values:ca,defaultWidth:"wide"}),day:oe({values:da,defaultWidth:"wide"}),dayPeriod:oe({values:ua,defaultWidth:"wide",formattingValues:ma,defaultFormattingWidth:"wide"})};function le(t){return(s,n={})=>{const o=n.width,i=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],h=s.match(i);if(!h)return null;const y=h[0],x=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth],b=Array.isArray(x)?ga(x,E=>E.test(y)):xa(x,E=>E.test(y));let d;d=t.valueCallback?t.valueCallback(b):b,d=n.valueCallback?n.valueCallback(d):d;const p=s.slice(y.length);return{value:d,rest:p}}}function xa(t,s){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&s(t[n]))return n}function ga(t,s){for(let n=0;n<t.length;n++)if(s(t[n]))return n}function st(t){return(s,n={})=>{const o=s.match(t.matchPattern);if(!o)return null;const i=o[0],h=s.match(t.parsePattern);if(!h)return null;let y=t.valueCallback?t.valueCallback(h[0]):h[0];y=n.valueCallback?n.valueCallback(y):y;const x=s.slice(i.length);return{value:y,rest:x}}}const pa=/^(\d+)(th|st|nd|rd)?/i,ya=/\d+/i,ba={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},va={any:[/^b/i,/^(a|c)/i]},wa={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ja={any:[/1/i,/2/i,/3/i,/4/i]},Na={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ma={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ka={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_a={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ca={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Da={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Sa={ordinalNumber:st({matchPattern:pa,parsePattern:ya,valueCallback:t=>parseInt(t,10)}),era:le({matchPatterns:ba,defaultMatchWidth:"wide",parsePatterns:va,defaultParseWidth:"any"}),quarter:le({matchPatterns:wa,defaultMatchWidth:"wide",parsePatterns:ja,defaultParseWidth:"any",valueCallback:t=>t+1}),month:le({matchPatterns:Na,defaultMatchWidth:"wide",parsePatterns:Ma,defaultParseWidth:"any"}),day:le({matchPatterns:ka,defaultMatchWidth:"wide",parsePatterns:_a,defaultParseWidth:"any"}),dayPeriod:le({matchPatterns:Ca,defaultMatchWidth:"any",parsePatterns:Da,defaultParseWidth:"any"})},Fa={code:"en-US",formatDistance:ea,formatLong:na,formatRelative:ia,localize:fa,match:Sa,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Pa(t,s,n){const o=Bt(),i=(n==null?void 0:n.locale)??o.locale??Fa,h=2520,y=Fe(t,s);if(isNaN(y))throw new RangeError("Invalid time value");const x=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:y});let b,d;y>0?(b=K(s),d=K(t)):(b=K(t),d=K(s));const p=Gt(d,b),E=(Je(d)-Je(b))/1e3,k=Math.round((p-E)/60);let _;if(k<2)return n!=null&&n.includeSeconds?p<5?i.formatDistance("lessThanXSeconds",5,x):p<10?i.formatDistance("lessThanXSeconds",10,x):p<20?i.formatDistance("lessThanXSeconds",20,x):p<40?i.formatDistance("halfAMinute",0,x):p<60?i.formatDistance("lessThanXMinutes",1,x):i.formatDistance("xMinutes",1,x):k===0?i.formatDistance("lessThanXMinutes",1,x):i.formatDistance("xMinutes",k,x);if(k<45)return i.formatDistance("xMinutes",k,x);if(k<90)return i.formatDistance("aboutXHours",1,x);if(k<He){const M=Math.round(k/60);return i.formatDistance("aboutXHours",M,x)}else{if(k<h)return i.formatDistance("xDays",1,x);if(k<De){const M=Math.round(k/He);return i.formatDistance("xDays",M,x)}else if(k<De*2)return _=Math.round(k/De),i.formatDistance("aboutXMonths",_,x)}if(_=Qt(d,b),_<12){const M=Math.round(k/De);return i.formatDistance("xMonths",M,x)}else{const M=_%12,v=Math.trunc(_/12);return M<3?i.formatDistance("aboutXYears",v,x):M<9?i.formatDistance("overXYears",v,x):i.formatDistance("almostXYears",v+1,x)}}function Ta(t,s){return Pa(t,Ut(t),s)}const Ia={lessThanXSeconds:{one:"sekunddan kam",other:"{{count}} sekunddan kam"},xSeconds:{one:"1 sekund",other:"{{count}} sekund"},halfAMinute:"yarim minut",lessThanXMinutes:{one:"bir minutdan kam",other:"{{count}} minutdan kam"},xMinutes:{one:"1 minut",other:"{{count}} minut"},aboutXHours:{one:"tahminan 1 soat",other:"tahminan {{count}} soat"},xHours:{one:"1 soat",other:"{{count}} soat"},xDays:{one:"1 kun",other:"{{count}} kun"},aboutXWeeks:{one:"tahminan 1 hafta",other:"tahminan {{count}} hafta"},xWeeks:{one:"1 hafta",other:"{{count}} hafta"},aboutXMonths:{one:"tahminan 1 oy",other:"tahminan {{count}} oy"},xMonths:{one:"1 oy",other:"{{count}} oy"},aboutXYears:{one:"tahminan 1 yil",other:"tahminan {{count}} yil"},xYears:{one:"1 yil",other:"{{count}} yil"},overXYears:{one:"1 yildan ko'p",other:"{{count}} yildan ko'p"},almostXYears:{one:"deyarli 1 yil",other:"deyarli {{count}} yil"}},Aa=(t,s,n)=>{let o;const i=Ia[t];return typeof i=="string"?o=i:s===1?o=i.one:o=i.other.replace("{{count}}",String(s)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?o+" dan keyin":o+" oldin":o},qa={full:"EEEE, do MMMM, y",long:"do MMMM, y",medium:"d MMM, y",short:"dd/MM/yyyy"},Wa={full:"h:mm:ss zzzz",long:"h:mm:ss z",medium:"h:mm:ss",short:"h:mm"},Ea={any:"{{date}}, {{time}}"},za={date:ge({formats:qa,defaultWidth:"full"}),time:ge({formats:Wa,defaultWidth:"full"}),dateTime:ge({formats:Ea,defaultWidth:"any"})},La={lastWeek:"'oldingi' eeee p 'da'",yesterday:"'kecha' p 'da'",today:"'bugun' p 'da'",tomorrow:"'ertaga' p 'da'",nextWeek:"eeee p 'da'",other:"P"},Ra=(t,s,n,o)=>La[t],Oa={narrow:["M.A","M."],abbreviated:["M.A","M."],wide:["Miloddan Avvalgi","Milodiy"]},$a={narrow:["1","2","3","4"],abbreviated:["CH.1","CH.2","CH.3","CH.4"],wide:["1-chi chorak","2-chi chorak","3-chi chorak","4-chi chorak"]},Ba={narrow:["Y","F","M","A","M","I","I","A","S","O","N","D"],abbreviated:["Yan","Fev","Mar","Apr","May","Iyun","Iyul","Avg","Sen","Okt","Noy","Dek"],wide:["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"]},Ua={narrow:["Y","D","S","CH","P","J","SH"],short:["Ya","Du","Se","Cho","Pa","Ju","Sha"],abbreviated:["Yak","Dush","Sesh","Chor","Pay","Jum","Shan"],wide:["Yakshanba","Dushanba","Seshanba","Chorshanba","Payshanba","Juma","Shanba"]},Va={narrow:{am:"a",pm:"p",midnight:"y.t",noon:"p.",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},abbreviated:{am:"AM",pm:"PM",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},wide:{am:"a.m.",pm:"p.m.",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"}},Ya={narrow:{am:"a",pm:"p",midnight:"y.t",noon:"p.",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},abbreviated:{am:"AM",pm:"PM",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"},wide:{am:"a.m.",pm:"p.m.",midnight:"yarim tun",noon:"peshin",morning:"ertalab",afternoon:"tushdan keyin",evening:"kechqurun",night:"tun"}},Xa=(t,s)=>String(t),Ha={ordinalNumber:Xa,era:oe({values:Oa,defaultWidth:"wide"}),quarter:oe({values:$a,defaultWidth:"wide",argumentCallback:t=>t-1}),month:oe({values:Ba,defaultWidth:"wide"}),day:oe({values:Ua,defaultWidth:"wide"}),dayPeriod:oe({values:Va,defaultWidth:"wide",formattingValues:Ya,defaultFormattingWidth:"wide"})},Ja=/^(\d+)(chi)?/i,Ka=/\d+/i,Qa={narrow:/^(m\.a|m\.)/i,abbreviated:/^(m\.a\.?\s?m\.?)/i,wide:/^(miloddan avval|miloddan keyin)/i},Ga={any:[/^b/i,/^(a|c)/i]},Za={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](chi)? chorak/i},er={any:[/1/i,/2/i,/3/i,/4/i]},tr={narrow:/^[yfmasond]/i,abbreviated:/^(yan|fev|mar|apr|may|iyun|iyul|avg|sen|okt|noy|dek)/i,wide:/^(yanvar|fevral|mart|aprel|may|iyun|iyul|avgust|sentabr|oktabr|noyabr|dekabr)/i},ar={narrow:[/^y/i,/^f/i,/^m/i,/^a/i,/^m/i,/^i/i,/^i/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ya/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^iyun/i,/^iyul/i,/^av/i,/^s/i,/^o/i,/^n/i,/^d/i]},rr={narrow:/^[ydschj]/i,short:/^(ya|du|se|cho|pa|ju|sha)/i,abbreviated:/^(yak|dush|sesh|chor|pay|jum|shan)/i,wide:/^(yakshanba|dushanba|seshanba|chorshanba|payshanba|juma|shanba)/i},nr={narrow:[/^y/i,/^d/i,/^s/i,/^ch/i,/^p/i,/^j/i,/^sh/i],any:[/^ya/i,/^d/i,/^se/i,/^ch/i,/^p/i,/^j/i,/^sh/i]},sr={narrow:/^(a|p|y\.t|p| (ertalab|tushdan keyin|kechqurun|tun))/i,any:/^([ap]\.?\s?m\.?|yarim tun|peshin| (ertalab|tushdan keyin|kechqurun|tun))/i},ir={any:{am:/^a/i,pm:/^p/i,midnight:/^y\.t/i,noon:/^pe/i,morning:/ertalab/i,afternoon:/tushdan keyin/i,evening:/kechqurun/i,night:/tun/i}},or={ordinalNumber:st({matchPattern:Ja,parsePattern:Ka,valueCallback:t=>parseInt(t,10)}),era:le({matchPatterns:Qa,defaultMatchWidth:"wide",parsePatterns:Ga,defaultParseWidth:"any"}),quarter:le({matchPatterns:Za,defaultMatchWidth:"wide",parsePatterns:er,defaultParseWidth:"any",valueCallback:t=>t+1}),month:le({matchPatterns:tr,defaultMatchWidth:"wide",parsePatterns:ar,defaultParseWidth:"any"}),day:le({matchPatterns:rr,defaultMatchWidth:"wide",parsePatterns:nr,defaultParseWidth:"any"}),dayPeriod:le({matchPatterns:sr,defaultMatchWidth:"any",parsePatterns:ir,defaultParseWidth:"any"})},lr={code:"uz",formatDistance:Aa,formatLong:za,formatRelative:Ra,localize:Ha,match:or,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ie=({duel:t,onAccept:s,onDecline:n,onPlay:o})=>{var _,M;const{user:i}=ke(),h=t.challenger_id===(i==null?void 0:i.id),y=t.opponent_id===(i==null?void 0:i.id),x=t.status==="pending",b=t.status==="active",d=t.status==="completed",p=t.winner_id===(i==null?void 0:i.id),E=d&&!t.winner_id,k=v=>v===0?"-":`${Math.floor(v/1e3)}s`;return e.jsxs(I.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`rounded-2xl p-4 border ${d?p?"bg-green-500/10 border-green-500/30":E?"bg-yellow-500/10 border-yellow-500/30":"bg-red-500/10 border-red-500/30":"bg-card border-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-primary"}),e.jsxs("span",{className:"font-semibold",children:[t.word_count," so'z"]})]}),x&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(et,{className:"w-4 h-4"}),Ta(new Date(t.expires_at),{locale:lr,addSuffix:!0})]}),d&&e.jsx("div",{className:"flex items-center gap-1",children:p?e.jsx(Me,{className:"w-5 h-5 text-yellow-500"}):E?e.jsx("span",{className:"text-sm text-yellow-600",children:"Durrang"}):e.jsx(Pe,{className:"w-5 h-5 text-red-500"})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(we,{className:"w-10 h-10",children:[e.jsx(je,{src:t.challenger_avatar}),e.jsx(Ne,{children:((_=t.challenger_name)==null?void 0:_[0])||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:h?"Siz":t.challenger_name}),(b||d)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t.challenger_score,"/",t.word_count]}),e.jsx(qe,{className:"w-3 h-3"}),e.jsx("span",{children:k(t.challenger_time_ms)})]})]})]}),e.jsx("span",{className:"text-lg font-bold text-muted-foreground",children:"VS"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-sm",children:y?"Siz":t.opponent_name}),(b||d)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t.opponent_score,"/",t.word_count]}),e.jsx(qe,{className:"w-3 h-3"}),e.jsx("span",{children:k(t.opponent_time_ms)})]})]}),e.jsxs(we,{className:"w-10 h-10",children:[e.jsx(je,{src:t.opponent_avatar}),e.jsx(Ne,{children:((M=t.opponent_name)==null?void 0:M[0])||"?"})]})]})]}),x&&y&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Z,{variant:"outline",size:"sm",onClick:n,className:"flex-1 gap-1",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Rad etish"]}),e.jsxs(Z,{size:"sm",onClick:s,className:"flex-1 gap-1",children:[e.jsx(ze,{className:"w-4 h-4"}),"Qabul qilish"]})]}),x&&h&&e.jsx("p",{className:"text-sm text-center text-muted-foreground",children:"Raqib javobini kutilmoqda..."}),b&&e.jsxs(Z,{size:"sm",onClick:o,className:"w-full gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"O'ynash"]}),d&&e.jsx("p",{className:"text-sm text-center font-medium",children:p?"ðŸŽ‰ Tabriklaymiz, siz g'olib!":E?"ðŸ¤ Durrang!":"Keyingi safar omad!"})]})},cr=({playerScore:t,opponentScore:s,totalQuestions:n,playerName:o,opponentName:i,lastResult:h,isComplete:y,winnerId:x,playerId:b})=>{const d=Wt(),[p,E]=g.useState(null),M=(t-s)/n*40;g.useEffect(()=>{h&&(E(h==="player"?"left":"right"),d.start({x:[0,h==="player"?-10:10,0],transition:{duration:.3,ease:"easeOut"}}),setTimeout(()=>E(null),500))},[t,s,h]);const v=D=>D>=8?{scale:1.3,emoji:"ðŸ’ªðŸ†",label:"Chempion"}:D>=6?{scale:1.2,emoji:"ðŸ’ª",label:"Kuchli"}:D>=4?{scale:1.1,emoji:"ðŸƒ",label:"Yaxshi"}:D>=2?{scale:1.05,emoji:"ðŸš¶",label:"O'rta"}:{scale:1,emoji:"ðŸ§",label:"Boshlang'ich"},c=v(t),A=v(s),f=x===b;return e.jsxs("div",{className:"relative py-6 px-4",children:[e.jsx(xe,{children:y&&e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 z-10 flex items-center justify-center pointer-events-none",children:e.jsx(I.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},className:`text-4xl ${f?"text-primary":"text-destructive"}`,children:f?"ðŸ†":"ðŸ˜”"})})}),e.jsxs("div",{className:"relative h-40 bg-gradient-to-b from-muted/30 to-muted/10 rounded-2xl overflow-hidden border border-muted",children:[e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-amber-900/30 to-transparent"}),e.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-muted-foreground/20 -translate-x-1/2"}),e.jsx(xe,{children:p&&e.jsx(e.Fragment,{children:[...Array(8)].map((D,q)=>e.jsx(I.div,{initial:{opacity:1,x:"50%",y:"50%",scale:1},animate:{opacity:0,x:p==="left"?`${30-q*5}%`:`${70+q*5}%`,y:`${40+Math.random()*20}%`,scale:.5},exit:{opacity:0},transition:{duration:.4,delay:q*.03},className:"absolute w-3 h-3 rounded-full bg-primary/50"},q))})}),e.jsx(I.div,{animate:{x:M},transition:{type:"spring",stiffness:100,damping:15},className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full",children:e.jsxs(I.div,{animate:d,className:"relative",children:[e.jsx("div",{className:"absolute left-8 right-8 h-3 bg-gradient-to-r from-amber-700 via-amber-600 to-amber-700 rounded-full top-1/2 -translate-y-1/2 shadow-md",children:[...Array(20)].map((D,q)=>e.jsx("div",{className:"absolute w-0.5 h-full bg-amber-800/30",style:{left:`${q*5}%`}},q))}),e.jsxs(I.div,{className:"absolute left-1/2 -translate-x-1/2 -top-6",animate:h?{y:[0,-5,0]}:{},transition:{duration:.3},children:[e.jsx("div",{className:"w-0.5 h-8 bg-muted-foreground"}),e.jsx("div",{className:"w-6 h-4 bg-destructive -mt-4 ml-0.5 rounded-r-sm shadow-sm"})]}),e.jsxs(I.div,{className:"absolute left-4 -translate-y-1/2 flex flex-col items-center",animate:{scale:c.scale,x:p==="left"?-5:0},transition:{type:"spring",stiffness:200},children:[e.jsx(I.div,{animate:p==="left"?{rotate:[-5,5,-5],x:[-3,0,-3]}:{},transition:{duration:.2},className:"text-3xl",children:c.emoji}),e.jsx("span",{className:"text-[10px] font-medium text-muted-foreground mt-1 whitespace-nowrap",children:o.slice(0,8)})]}),e.jsxs(I.div,{className:"absolute right-4 -translate-y-1/2 flex flex-col items-center",animate:{scale:A.scale,x:p==="right"?5:0},transition:{type:"spring",stiffness:200},children:[e.jsx(I.div,{animate:p==="right"?{rotate:[5,-5,5],x:[3,0,3]}:{},transition:{duration:.2},className:"text-3xl transform scale-x-[-1]",children:A.emoji}),e.jsx("span",{className:"text-[10px] font-medium text-muted-foreground mt-1 whitespace-nowrap",children:i.slice(0,8)})]})]})}),e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1/4 bg-gradient-to-r from-primary/20 to-transparent"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1/4 bg-gradient-to-l from-destructive/20 to-transparent"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 px-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I.div,{animate:{scale:h==="player"?[1,1.3,1]:1},className:`text-2xl font-bold ${t>s?"text-primary":"text-foreground"}`,children:t}),e.jsx("span",{className:"text-xs text-muted-foreground",children:c.label})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"vs"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:A.label}),e.jsx(I.div,{animate:{scale:h==="opponent"?[1,1.3,1]:1},className:`text-2xl font-bold ${s>t?"text-destructive":"text-foreground"}`,children:s})]})]})]})},dr=({duel:t,onComplete:s})=>{const{user:n}=ke(),{submitAnswer:o}=Re(),[i,h]=g.useState(0),[y,x]=g.useState(""),[b,d]=g.useState(Date.now()),[p,E]=g.useState([]),[k,_]=g.useState(!1),[M,v]=g.useState(null),[c,A]=g.useState(!1),[f,D]=g.useState(0),[q,U]=g.useState(!1),[B,F]=g.useState(0),[l,u]=g.useState(null),C=t.words[i],ee=i/t.word_count*100;g.useEffect(()=>{if(c)return;const z=setInterval(()=>{D(Date.now()-b)},100);return()=>clearInterval(z)},[b,c]),g.useEffect(()=>{if(c){U(!0);const z=p.filter(R=>R.correct).length/t.word_count;z>=.8?(nt(),setTimeout(()=>Rt(),500)):z>=.5&&rt()}},[c,p,t.word_count]);const H=g.useCallback(async()=>{if(!y.trim()||!C)return;const z=Date.now()-b,R=y.trim().toLowerCase()===C.translated_word.toLowerCase();v(R),_(!0),await o(t.id,i,R,z),E(r=>[...r,{correct:R,time:z}]),R?(F(r=>r+1),u("player")):u("opponent"),setTimeout(()=>u(null),600),setTimeout(()=>{_(!1),i+1>=t.word_count?A(!0):(h(r=>r+1),x(""),d(Date.now()))},1e3)},[y,C,i,t.id,t.word_count,o,b]),te=z=>{z.key==="Enter"&&H()},G=z=>{const R=Math.floor(z/1e3),r=Math.floor(z%1e3/100);return`${R}.${r}s`},re=p.filter(z=>z.correct).length,fe=p.reduce((z,R)=>z+R.time,0),ae=t.word_count>0?re/t.word_count*100:0;return c?e.jsxs(I.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12 relative",children:[e.jsx(xe,{children:q&&e.jsx(e.Fragment,{children:[...Array(12)].map((z,R)=>e.jsx(I.div,{initial:{opacity:0,scale:0,x:0,y:0},animate:{opacity:[0,1,0],scale:[0,1,.5],x:(Math.random()-.5)*200,y:(Math.random()-.5)*200},transition:{duration:2,delay:R*.1,repeat:1/0,repeatDelay:1},className:"absolute left-1/2 top-1/4 text-2xl",children:["âœ¨","â­","ðŸŒŸ","ðŸ’«"][R%4]},R))})}),e.jsxs(I.div,{initial:{rotate:0,y:20},animate:{rotate:[0,-10,10,-10,0],y:[20,0,-10,0]},transition:{delay:.3,duration:.8,ease:"easeOut"},className:`w-28 h-28 mx-auto mb-6 rounded-3xl flex items-center justify-center relative ${ae>=80?"bg-gradient-to-br from-yellow-400 via-yellow-500 to-amber-600":ae>=50?"bg-gradient-to-br from-primary to-secondary":"bg-gradient-to-br from-gray-400 to-gray-500"}`,children:[ae>=80?e.jsx(tt,{className:"w-14 h-14 text-white drop-shadow-lg"}):ae>=50?e.jsx(Me,{className:"w-14 h-14 text-primary-foreground drop-shadow-lg"}):e.jsx(We,{className:"w-14 h-14 text-white drop-shadow-lg"}),ae>=80&&e.jsx(I.div,{animate:{scale:[1,1.2,1],opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 rounded-3xl bg-yellow-400 blur-xl -z-10"})]}),e.jsxs(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx("h2",{className:"font-display font-bold text-3xl mb-2 flex items-center justify-center gap-2",children:ae>=80?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"w-6 h-6 text-yellow-500"}),"Zo'r natija!",e.jsx(Ye,{className:"w-6 h-6 text-yellow-500"})]}):ae>=50?"Yaxshi!":"Tugatildi!"}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["Natijangiz: ",re,"/",t.word_count," to'g'ri (",Math.round(ae),"%)"]})]}),e.jsx(I.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.7},className:"bg-card rounded-2xl p-6 mb-6 max-w-sm mx-auto shadow-elevated",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx(I.p,{initial:{scale:0},animate:{scale:1},transition:{delay:.9,type:"spring"},className:"text-3xl font-bold text-green-500",children:re}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"To'g'ri"})]}),e.jsxs("div",{children:[e.jsx(I.p,{initial:{scale:0},animate:{scale:1},transition:{delay:1,type:"spring"},className:"text-3xl font-bold text-red-500",children:t.word_count-re}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Noto'g'ri"})]}),e.jsxs("div",{children:[e.jsx(I.p,{initial:{scale:0},animate:{scale:1},transition:{delay:1.1,type:"spring"},className:"text-3xl font-bold",children:G(fe)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vaqt"})]})]})}),e.jsx(I.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},className:"text-sm text-muted-foreground mb-6",children:"Raqibingiz o'ynashini kuting..."}),e.jsx(I.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:1.4},children:e.jsxs(Z,{onClick:s,variant:"outline",className:"gap-2",children:[e.jsx(vt,{className:"w-4 h-4"}),"Orqaga"]})})]}):e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx(cr,{playerScore:B,opponentScore:t.word_count-i-B,totalQuestions:t.word_count,playerName:t.challenger_id===(n==null?void 0:n.id)?t.challenger_name||"Siz":t.opponent_name||"Siz",opponentName:t.challenger_id===(n==null?void 0:n.id)?t.opponent_name||"Raqib":t.challenger_name||"Raqib",lastResult:l,isComplete:c,winnerId:null,playerId:(n==null?void 0:n.id)||""}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:[i+1," / ",t.word_count]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-primary",children:[e.jsx(qe,{className:"w-4 h-4"}),G(f)]})]}),e.jsx(bt,{value:ee,className:"h-2"})]}),e.jsx("div",{className:"flex justify-center gap-2 mb-6",children:Array.from({length:t.word_count}).map((z,R)=>e.jsx(I.div,{initial:R===i?{scale:0}:{},animate:R===i?{scale:1}:{},className:`w-3 h-3 rounded-full transition-colors ${R<p.length?p[R].correct?"bg-green-500":"bg-red-500":R===i?"bg-primary animate-pulse":"bg-muted"}`},R))}),e.jsx(xe,{mode:"wait",children:e.jsxs(I.div,{initial:{opacity:0,x:50,rotateY:-15},animate:{opacity:1,x:0,rotateY:0},exit:{opacity:0,x:-50,rotateY:15},transition:{type:"spring",stiffness:300,damping:25},className:"bg-card rounded-3xl p-8 shadow-elevated mb-6 relative overflow-hidden",children:[e.jsx(xe,{children:k&&e.jsx(I.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.1},className:`absolute inset-0 flex items-center justify-center ${M?"bg-green-500/90":"bg-red-500/90"}`,children:M?e.jsx(I.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200},children:e.jsx(ze,{className:"w-20 h-20 text-white drop-shadow-lg"})}):e.jsxs(I.div,{initial:{scale:0},animate:{scale:1},className:"text-center text-white",children:[e.jsx(I.div,{animate:{x:[-5,5,-5,5,0]},transition:{duration:.4},children:e.jsx(Pe,{className:"w-20 h-20 mx-auto mb-2 drop-shadow-lg"})}),e.jsx("p",{className:"font-medium text-lg",children:C==null?void 0:C.translated_word})]})})}),e.jsx("p",{className:"text-center text-sm text-muted-foreground mb-2",children:"Tarjima qiling:"}),e.jsx(I.h2,{initial:{scale:.9},animate:{scale:1},className:"text-center font-display font-bold text-3xl mb-6",children:C==null?void 0:C.original_word}),e.jsx(Qe,{value:y,onChange:z=>x(z.target.value),onKeyPress:te,placeholder:"Tarjimani kiriting...",className:"text-center text-lg h-14",autoFocus:!0,disabled:k})]},i)}),e.jsx(I.div,{whileTap:{scale:.98},children:e.jsx(Z,{onClick:H,className:"w-full h-14 text-lg",disabled:!y.trim()||k,children:"Tasdiqlash"})})]})},ur=({trigger:t})=>{const{friends:s}=at(),{createDuel:n}=Re(),[o,i]=g.useState(!1),[h,y]=g.useState(null),[x,b]=g.useState(5),[d,p]=g.useState(!1),E=async()=>{if(!h)return;p(!0);const _=await n(h,x);p(!1),_&&(i(!1),y(null))},k=s.filter(_=>_.status==="accepted");return e.jsxs(wt,{open:o,onOpenChange:i,children:[e.jsx(jt,{asChild:!0,children:t||e.jsxs(Z,{className:"gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Duel boshlash"]})}),e.jsxs(Nt,{children:[e.jsx(Mt,{children:e.jsxs(kt,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5"}),"Yangi duel"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"So'zlar soni:"}),e.jsx("div",{className:"flex gap-2",children:[5,10,15].map(_=>e.jsxs(Z,{variant:x===_?"default":"outline",size:"sm",onClick:()=>b(_),children:[_," so'z"]},_))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Raqibni tanlang:"}),k.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Se,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Do'stlaringiz yo'q"}),e.jsx("p",{className:"text-xs",children:"Avval do'st qo'shing"})]}):e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:k.map(_=>{var M;return e.jsxs("button",{onClick:()=>y(_.friendId),className:`w-full flex items-center gap-3 p-3 rounded-xl transition-colors ${h===_.friendId?"bg-primary/10 border-2 border-primary":"bg-muted/50 hover:bg-muted border-2 border-transparent"}`,children:[e.jsxs(we,{children:[e.jsx(je,{src:_.avatarUrl||void 0}),e.jsx(Ne,{children:((M=_.fullName)==null?void 0:M[0])||"?"})]}),e.jsx("div",{className:"text-left",children:e.jsx("p",{className:"font-medium",children:_.fullName||"Noma'lum"})})]},_.id)})})]}),e.jsxs(Z,{onClick:E,disabled:!h||d,className:"w-full gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),d?"Yuborilmoqda...":"Duel yuborish"]})]})]})]})},mr=()=>{const{pendingDuels:t,activeDuels:s,completedDuels:n,activeDuel:o,isLoading:i,acceptDuel:h,declineDuel:y,startDuel:x,endDuel:b}=Re();return i?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Yuklanmoqda..."}):o?e.jsx(dr,{duel:o,onComplete:b}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"font-display font-semibold text-xl flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5"}),"So'z duellari"]}),e.jsx(ur,{})]}),e.jsxs(Ge,{defaultValue:"pending",className:"w-full",children:[e.jsxs(Ze,{className:"grid w-full grid-cols-3",children:[e.jsxs(be,{value:"pending",className:"gap-1",children:[e.jsx(et,{className:"w-4 h-4"}),"Kutilmoqda",t.length>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-primary text-primary-foreground rounded-full",children:t.length})]}),e.jsxs(be,{value:"active",className:"gap-1",children:[e.jsx(de,{className:"w-4 h-4"}),"Faol",s.length>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-green-500 text-white rounded-full",children:s.length})]}),e.jsxs(be,{value:"completed",className:"gap-1",children:[e.jsx(Me,{className:"w-4 h-4"}),"Tugatilgan"]})]}),e.jsx(ve,{value:"pending",className:"mt-4",children:t.length===0?e.jsx(Ae,{message:"Kutilayotgan duellar yo'q"}):e.jsx("div",{className:"space-y-3",children:t.map(d=>e.jsx(Ie,{duel:d,onAccept:()=>h(d.id),onDecline:()=>y(d.id)},d.id))})}),e.jsx(ve,{value:"active",className:"mt-4",children:s.length===0?e.jsx(Ae,{message:"Faol duellar yo'q"}):e.jsx("div",{className:"space-y-3",children:s.map(d=>e.jsx(Ie,{duel:d,onPlay:()=>x(d)},d.id))})}),e.jsx(ve,{value:"completed",className:"mt-4",children:n.length===0?e.jsx(Ae,{message:"Tugatilgan duellar yo'q"}):e.jsx("div",{className:"space-y-3",children:n.slice(0,10).map(d=>e.jsx(Ie,{duel:d},d.id))})})]})]})},Ae=({message:t})=>e.jsxs(I.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 text-muted-foreground",children:[e.jsx(de,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:t})]}),Sr=()=>{const{friends:t,pendingRequests:s,myFriendCode:n,isLoading:o,addFriendByCode:i,acceptRequest:h,rejectRequest:y,removeFriend:x}=at(),{globalLeaderboard:b,isLoading:d,myRank:p,getTopUsers:E}=Et(),[k,_]=g.useState(""),[M,v]=g.useState(!1),[c,A]=g.useState(!1),f=()=>{n&&(navigator.clipboard.writeText(n),v(!0),X.success("Kod nusxalandi!"),setTimeout(()=>v(!1),2e3))},D=async()=>{if(!k.trim())return;A(!0),await i(k.trim())&&_(""),A(!1)};if(o||d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center pb-20",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Yuklanmoqda..."})});const U=l=>l===1?e.jsx(tt,{className:"w-5 h-5 text-yellow-500"}):l===2?e.jsx(We,{className:"w-5 h-5 text-gray-400"}):l===3?e.jsx(We,{className:"w-5 h-5 text-amber-700"}):null,B=(l,u)=>u?"bg-gradient-to-r from-primary/20 to-primary/5 border border-primary/30 ring-2 ring-primary/20":l===1?"bg-gradient-to-r from-yellow-500/20 to-yellow-500/5 border border-yellow-500/30":l===2?"bg-gradient-to-r from-gray-400/20 to-gray-400/5 border border-gray-400/30":l===3?"bg-gradient-to-r from-amber-700/20 to-amber-700/5 border border-amber-700/30":"bg-muted/50",F=({entry:l,showRemove:u=!1,onRemove:C})=>e.jsxs(I.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`flex items-center gap-3 p-3 rounded-xl ${B(l.rank,l.isCurrentUser)}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${l.rank===1?"bg-yellow-500 text-yellow-950":l.rank===2?"bg-gray-400 text-gray-950":l.rank===3?"bg-amber-700 text-white":"bg-muted text-muted-foreground"}`,children:U(l.rank)||l.rank}),e.jsxs(we,{className:"h-10 w-10",children:[e.jsx(je,{src:l.avatarUrl||void 0}),e.jsx(Ne,{children:(l.fullName||"U").charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-medium truncate flex items-center gap-1",children:[l.fullName||"Foydalanuvchi",l.isCurrentUser&&e.jsx(Ve,{variant:"secondary",className:"text-xs ml-1",children:"Siz"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Dt,{className:"w-3 h-3 text-primary"}),"Lvl ",l.level]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ct,{className:"w-3 h-3 text-orange-500"}),l.streak]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(yt,{className:"w-3 h-3"}),l.totalWords]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-primary",children:l.xp.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"XP"})]}),u&&C&&e.jsx(Z,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:C,children:e.jsx(Pe,{className:"w-4 h-4"})})]});return e.jsx("div",{className:"min-h-screen pb-24 pt-4 px-4",children:e.jsxs(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center justify-center gap-2",children:[e.jsx(Se,{className:"w-6 h-6 text-primary"}),"Do'stlar va Reyting"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:p&&`Sizning o'rningiz: #${p}`})]}),e.jsx(pe,{className:"border-primary/20 bg-primary/5",children:e.jsxs(ye,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Mening kodim:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-background rounded-lg px-4 py-3 font-mono text-xl tracking-widest text-center",children:n||"--------"}),e.jsx(Z,{size:"icon",variant:"outline",onClick:f,className:"h-12 w-12",children:M?e.jsx(ze,{className:"w-5 h-5 text-green-500"}):e.jsx(_t,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Bu kodni do'stlaringizga yuboring"})]})}),e.jsxs(pe,{children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(Ce,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ft,{className:"w-5 h-5"}),"Do'st qo'shish"]})}),e.jsx(ye,{className:"space-y-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Qe,{placeholder:"Do'st kodini kiriting",value:k,onChange:l=>_(l.target.value.toUpperCase()),className:"font-mono tracking-wider",maxLength:8}),e.jsx(Z,{onClick:D,disabled:c||!k.trim(),children:c?"Yuborilmoqda...":"Qo'shish"})]})})]}),e.jsx(xe,{children:s.length>0&&e.jsx(I.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsxs(pe,{className:"border-yellow-500/20 bg-yellow-500/5",children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(Ce,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ve,{variant:"secondary",className:"bg-yellow-500/20",children:s.length}),"Kutilayotgan so'rovlar"]})}),e.jsx(ye,{className:"space-y-3",children:s.map(l=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-background",children:[e.jsxs(we,{className:"h-10 w-10",children:[e.jsx(je,{src:l.avatarUrl||void 0}),e.jsx(Ne,{children:l.fullName.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:l.fullName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Do'st bo'lishni xohlaydi"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Z,{size:"icon",variant:"outline",className:"h-9 w-9 text-green-500 hover:bg-green-500/10",onClick:()=>h(l.id),children:e.jsx(St,{className:"w-4 h-4"})}),e.jsx(Z,{size:"icon",variant:"outline",className:"h-9 w-9 text-red-500 hover:bg-red-500/10",onClick:()=>y(l.id),children:e.jsx(Pt,{className:"w-4 h-4"})})]})]},l.id))})]})})}),e.jsx(mr,{}),e.jsxs(Ge,{defaultValue:"global",className:"w-full",children:[e.jsxs(Ze,{className:"grid w-full grid-cols-2",children:[e.jsxs(be,{value:"global",className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Umumiy"]}),e.jsxs(be,{value:"friends",className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),"Do'stlar"]})]}),e.jsx(ve,{value:"global",children:e.jsxs(pe,{children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(Ce,{className:"text-lg flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-yellow-500"}),"Top 50 - Global Reyting"]})}),e.jsx(ye,{children:E(50).length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Xe,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Hali foydalanuvchilar yo'q"})]}):e.jsx("div",{className:"space-y-3",children:E(50).map((l,u)=>e.jsx(F,{entry:{...l,rank:u+1}},l.userId))})})]})}),e.jsx(ve,{value:"friends",children:e.jsxs(pe,{children:[e.jsx(_e,{className:"pb-3",children:e.jsxs(Ce,{className:"text-lg flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-yellow-500"}),"Do'stlar Reytingi"]})}),e.jsx(ye,{children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Se,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Hali do'stlar yo'q"}),e.jsx("p",{className:"text-sm mt-1",children:"Kodingizni do'stlaringizga yuboring yoki ularning kodini kiriting"})]}):e.jsx("div",{className:"space-y-3",children:t.map((l,u)=>e.jsx(F,{entry:{...l,rank:u+1,isCurrentUser:!1},showRemove:!0,onRemove:()=>x(l.id)},l.id))})})]})})]})]})})};export{Sr as default};
